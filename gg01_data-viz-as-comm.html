<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Visualization as Communication</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">bmRn R Training</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Lessons and exercises</a>
</li>
<li>
  <a href="slides.html">Slides</a>
</li>
<li>
  <a href="more-resources.html">More resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data Visualization as Communication</h1>

</div>


<div id="objectives" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Objectives</h1>
<p>In order to use graphs and figures to effectively communicate with our audience, we need to consider a few things:</p>
<ol style="list-style-type: decimal">
<li>Recognize the needs of your audience (who are they, and where are they coming from?)</li>
</ol>
<ul>
<li><em>level of data literacy, subject matter expertise, etc.</em></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Communicate the quality of the data with stakeholders (can we answer their question(s) with the available data?)</li>
</ol>
<ul>
<li><em>let them know the good and the bad news</em></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Identify the correct data visualization (based on the data <em>and</em> the problem/question)</li>
</ol>
<ul>
<li><em>single variable, bivariate, and multivariate graphs</em></li>
</ul>
</div>
<div id="materials" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Materials</h1>
<ul>
<li><p>The slides for this lesson are <a href="https://mjfrigaard.github.io/data-viz-as-comm/Index.html">here</a></p></li>
<li><p><a href="https://rstudio.cloud/project/1983257">RStudio.Cloud Project</a></p></li>
</ul>
</div>
<div id="previous-lessons" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Previous lessons</h1>
<p>All of the exercises and lessons are available <a href="https://mjfrigaard.github.io/r-meetup-tutorials/">here</a>. Read more about <a href="https://ggplot2.tidyverse.org/index.html"><code>ggplot2</code></a> on the tidyverse website, and in the <a href="https://r4ds.had.co.nz/data-visualisation.html">Data Visualisation</a> chapter of R for Data Science.</p>
</div>
<div id="load-the-packages" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Load the packages</h1>
<p>The main packages we’re going to use are <code>dplyr</code>, <code>tidyr</code>, and <code>ggplot2</code>. These are all part of the <code>tidyverse</code>, so we’ll import this package below:</p>
<pre class="r"><code>install.packages(&quot;tidyverse&quot;)
library(tidyverse)</code></pre>
</div>
<div id="example-covid-and-mobility" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Example: COVID and Mobility</h1>
<p>Assume we received the following questions from a stakeholder:</p>
<p><strong><em>How has COVID changed our modes of transportation?</em></strong></p>
<p>Or</p>
<p><strong><em>Are people using fewer or different forms of transportation since the COVID pandemic?</em></strong></p>
<p>Questions we should be considering:</p>
<ol style="list-style-type: decimal">
<li>What kind of measurements would this be?</li>
</ol>
<ul>
<li><em>how people travel (walk, drive, etc.)</em></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>What would these data look like?</li>
</ol>
<ul>
<li><em>what would the columns and rows look like?</em></li>
</ul>
<div id="data-import" class="section level2 tabset" number="5.1">
<h2 class="tabset" number="5.1"><span class="header-section-number">5.1</span> Data Import</h2>
<p>We’re going to use the following data to answer the stakeholder’s questions:</p>
<ul>
<li>Apple mobility data: <a href="https://covid19.apple.com/mobility" class="uri">https://covid19.apple.com/mobility</a></li>
</ul>
<p>Import the data below</p>
<pre class="r"><code>AppleMobRaw &lt;- readr::read_csv(&quot;https://bit.ly/36tTVpe&quot;)</code></pre>
<div id="tidy-applemobraw" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> Tidy <code>AppleMobRaw</code></h3>
<p>These data need to be restructured into a tidy format.</p>
<pre class="r"><code>AppleMobRaw %&gt;% 
  tidyr::pivot_longer(cols = -c(geo_type:country), 
                      names_to = &quot;date&quot;, 
                      values_to = &quot;dir_request&quot;)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["transportation_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub-region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["chr"],"align":["left"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-13","7":"100.00"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-14","7":"95.30"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-15","7":"101.43"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-16","7":"97.20"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-17","7":"103.55"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-18","7":"112.67"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-19","7":"104.83"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-20","7":"94.39"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-21","7":"94.07"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-22","7":"93.51"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-23","7":"92.94"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-24","7":"102.13"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-25","7":"102.38"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-26","7":"101.41"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-27","7":"94.62"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-28","7":"89.12"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-29","7":"90.17"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-30","7":"90.21"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-01-31","7":"97.71"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-01","7":"102.50"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-02","7":"108.92"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-03","7":"92.82"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-04","7":"91.48"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-05","7":"93.99"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-06","7":"96.72"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-07","7":"102.46"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-08","7":"103.29"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-09","7":"107.83"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-10","7":"87.99"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-11","7":"94.18"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-12","7":"94.62"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-13","7":"99.70"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-14","7":"139.30"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-15","7":"123.90"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-16","7":"129.41"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-17","7":"102.24"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-18","7":"88.09"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-19","7":"88.17"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-20","7":"94.48"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-21","7":"100.62"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-22","7":"111.02"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-23","7":"113.50"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-24","7":"86.95"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-25","7":"83.01"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-26","7":"85.44"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-27","7":"82.73"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-28","7":"89.70"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-02-29","7":"95.48"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-01","7":"100.43"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-02","7":"89.25"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-03","7":"91.02"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-04","7":"89.72"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-05","7":"94.87"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-06","7":"102.82"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-07","7":"109.92"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-08","7":"110.07"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-09","7":"79.68"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-10","7":"68.24"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-11","7":"51.77"},{"1":"country/region","2":"Albania","3":"driving","4":"NA","5":"NA","6":"2020-03-12","7":"43.79"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="wrangle-applemobraw" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> Wrangle <code>AppleMobRaw</code></h3>
<p>We will remove the missing values from <code>country</code> and <code>sub-region</code></p>
<pre class="r"><code>AppleMobRaw %&gt;% 
  tidyr::pivot_longer(cols = -c(geo_type:country), 
                      names_to = &quot;date&quot;, values_to = &quot;dir_request&quot;) %&gt;% 
    # remove missing country and missing sub-region data
  dplyr::filter(!is.na(country) &amp; !is.na(`sub-region`))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["transportation_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub-region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["chr"],"align":["left"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-13","7":"100.00"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-14","7":"100.73"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-15","7":"102.86"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-16","7":"102.65"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-17","7":"109.39"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-18","7":"109.62"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-19","7":"98.21"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-20","7":"102.74"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-21","7":"103.85"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-22","7":"102.01"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-23","7":"101.40"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-24","7":"107.57"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-25","7":"109.13"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-26","7":"97.51"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-27","7":"101.64"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-28","7":"100.59"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-29","7":"103.33"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-30","7":"104.31"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-01-31","7":"113.82"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-01","7":"113.59"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-02","7":"98.83"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-03","7":"103.15"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-04","7":"103.89"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-05","7":"101.56"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-06","7":"102.56"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-07","7":"111.98"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-08","7":"112.91"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-09","7":"88.21"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-10","7":"105.14"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-11","7":"107.55"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-12","7":"107.62"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-13","7":"110.29"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-14","7":"121.38"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-15","7":"115.58"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-16","7":"98.64"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-17","7":"108.30"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-18","7":"111.55"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-19","7":"106.26"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-20","7":"98.08"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-21","7":"106.48"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-22","7":"96.88"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-23","7":"82.05"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-24","7":"87.53"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-25","7":"97.50"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-26","7":"97.03"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-27","7":"105.28"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-28","7":"102.80"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-02-29","7":"103.48"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-01","7":"92.08"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-02","7":"95.39"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-03","7":"100.71"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-04","7":"101.12"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-05","7":"102.29"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-06","7":"108.11"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-07","7":"107.92"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-08","7":"96.28"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-09","7":"94.72"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-10","7":"96.77"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-11","7":"111.70"},{"1":"city","2":"Aachen","3":"driving","4":"North Rhine-Westphalia","5":"Germany","6":"2020-03-12","7":"90.88"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Use <code>mutate()</code> to create a properly formatted <code>date</code> variable, and <code>rename()</code> the <code>transportation_type</code> variable to <code>trans_type</code>. Apply <code>janitor::clean_names()</code> to the entire dataset and assign the final output to <code>TidyApple</code>.</p>
<pre class="r"><code>AppleMobRaw %&gt;% 
  tidyr::pivot_longer(cols = -c(geo_type:country), 
                      names_to = &quot;date&quot;, values_to = &quot;dir_request&quot;) %&gt;% 
    # remove missing country and missing sub-region data
  dplyr::filter(!is.na(country) &amp; !is.na(`sub-region`)) %&gt;% 
  # format date
  mutate(date = lubridate::ymd(date)) %&gt;% 
  # change name of transportation types
  rename(trans_type = transportation_type) %&gt;% 
  # clean names 
  janitor::clean_names() -&gt; TidyApple</code></pre>
</div>
</div>
<div id="counting" class="section level2 tabset" number="5.2">
<h2 class="tabset" number="5.2"><span class="header-section-number">5.2</span> Counting</h2>
<p>One of the most important jobs of analytic work is <a href="https://cran.r-project.org/web/packages/janitor/vignettes/tabyls.html">counting things</a>. There are many ways to accomplish this in R, but we’ll stick with the <code>dplyr</code> package because it’s part of the <code>tidyverse</code>.</p>
<p>The <code>dplyr</code> function for counting responses of a categorical or factor variable is <code>count()</code>, and it works like this:</p>
<pre class="r"><code>Data %&gt;% 
  count(variable)</code></pre>
<div id="count" class="section level3" number="5.2.1">
<h3 number="5.2.1"><span class="header-section-number">5.2.1</span> Count</h3>
<p>So, if we wanted to count the number of different transportation types in the <code>TidyApple</code> data frame, it would look like this,</p>
<pre class="r"><code>TidyApple %&gt;% 
  dplyr::count(trans_type)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["trans_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"driving","2":"743682"},{"1":"transit","2":"106512"},{"1":"walking","2":"205099"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="count-sort" class="section level3" number="5.2.2">
<h3 number="5.2.2"><span class="header-section-number">5.2.2</span> Count &amp; sort</h3>
<p>We can also sort the responses using the <code>sort = TRUE</code> argument.</p>
<pre class="r"><code>TidyApple %&gt;% 
  dplyr::count(trans_type, sort = TRUE)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["trans_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"driving","2":"743682"},{"1":"walking","2":"205099"},{"1":"transit","2":"106512"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="iterate-with-count" class="section level3" number="5.2.3">
<h3 number="5.2.3"><span class="header-section-number">5.2.3</span> Iterate with count</h3>
<p>We can also combine <code>dplyr::select_if()</code> and <code>purrr::map()</code> to pass the <code>count()</code> function to all the character variables in <code>TidyApple</code>.</p>
<pre class="r"><code>TidyApple %&gt;% 
  select_if(is.character) %&gt;% 
  map(~count(data.frame(x = .x), x, sort = TRUE)) -&gt; tidy_apple_counts</code></pre>
<p>We can example the counts of each value by using the <code>$</code> to subset the <code>tidy_apple_counts</code> list.</p>
<pre class="r"><code>tidy_apple_counts$sub_region</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Texas","2":"76397"},{"1":"California","2":"52622"},{"1":"Georgia","2":"41527"},{"1":"Virginia","2":"38991"},{"1":"Florida","2":"38357"},{"1":"Ohio","2":"38357"},{"1":"North Carolina","2":"35821"},{"1":"New York","2":"33602"},{"1":"Pennsylvania","2":"32651"},{"1":"Indiana","2":"29481"},{"1":"Michigan","2":"28530"},{"1":"Tennessee","2":"27262"},{"1":"Illinois","2":"26945"},{"1":"Missouri","2":"24409"},{"1":"Kentucky","2":"23458"},{"1":"Alabama","2":"20922"},{"1":"Wisconsin","2":"19971"},{"1":"Colorado","2":"19654"},{"1":"Minnesota","2":"19654"},{"1":"Mississippi","2":"19654"},{"1":"Oklahoma","2":"19654"},{"1":"Louisiana","2":"19337"},{"1":"South Carolina","2":"18069"},{"1":"Iowa","2":"17752"},{"1":"Washington","2":"17118"},{"1":"Arkansas","2":"15850"},{"1":"New Jersey","2":"14582"},{"1":"Oregon","2":"14265"},{"1":"Maryland","2":"13631"},{"1":"Kansas","2":"12363"},{"1":"England","2":"11412"},{"1":"Massachusetts","2":"11412"},{"1":"New Mexico","2":"10144"},{"1":"Arizona","2":"9193"},{"1":"Nebraska","2":"8876"},{"1":"Utah","2":"8876"},{"1":"West Virginia","2":"8876"},{"1":"Connecticut","2":"7608"},{"1":"Idaho","2":"6974"},{"1":"Nevada","2":"6023"},{"1":"Puerto Rico","2":"5706"},{"1":"Hawaii","2":"4755"},{"1":"Maine","2":"4755"},{"1":"North Rhine-Westphalia","2":"4755"},{"1":"Vermont","2":"4121"},{"1":"Montana","2":"3804"},{"1":"New Hampshire","2":"3804"},{"1":"North Dakota","2":"3804"},{"1":"Wyoming","2":"3804"},{"1":"Rhode Island","2":"3487"},{"1":"South Dakota","2":"3487"},{"1":"Shizuoka Prefecture","2":"2853"},{"1":"Alaska","2":"2536"},{"1":"Baden-Württemberg","2":"2536"},{"1":"Provence-Alpes-Côte d'Azur Region","2":"2536"},{"1":"Bavaria","2":"2219"},{"1":"Aichi Prefecture","2":"1902"},{"1":"Alberta","2":"1902"},{"1":"Delaware","2":"1902"},{"1":"Fukuoka Prefecture","2":"1902"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>tidy_apple_counts$region</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Washington County","2":"8559"},{"1":"Jefferson County","2":"7925"},{"1":"Montgomery County","2":"7608"},{"1":"Franklin County","2":"6974"},{"1":"Madison County","2":"6657"},{"1":"Jackson County","2":"6023"},{"1":"Marion County","2":"5389"},{"1":"Monroe County","2":"5072"},{"1":"Greene County","2":"4121"},{"1":"Lincoln County","2":"4121"},{"1":"Orange County","2":"4121"},{"1":"Union County","2":"4121"},{"1":"Clark County","2":"3804"},{"1":"Douglas County","2":"3804"},{"1":"Lee County","2":"3804"},{"1":"Warren County","2":"3804"},{"1":"Adams County","2":"3487"},{"1":"Polk County","2":"3487"},{"1":"Wayne County","2":"3487"},{"1":"Carroll County","2":"3170"},{"1":"Hamilton County","2":"3170"},{"1":"Henry County","2":"3170"},{"1":"Lake County","2":"3170"},{"1":"Shelby County","2":"3170"},{"1":"Benton County","2":"2853"},{"1":"Cass County","2":"2853"},{"1":"Clay County","2":"2853"},{"1":"Cumberland County","2":"2853"},{"1":"Delaware County","2":"2853"},{"1":"Fayette County","2":"2853"},{"1":"Cherokee County","2":"2536"},{"1":"Clinton County","2":"2536"},{"1":"Fulton County","2":"2536"},{"1":"Johnson County","2":"2536"},{"1":"Lawrence County","2":"2536"},{"1":"Marshall County","2":"2536"},{"1":"Boone County","2":"2219"},{"1":"Brown County","2":"2219"},{"1":"Columbia County","2":"2219"},{"1":"DeKalb County","2":"2219"},{"1":"Essex County","2":"2219"},{"1":"Jasper County","2":"2219"},{"1":"Kent County","2":"2219"},{"1":"Knox County","2":"2219"},{"1":"Mercer County","2":"2219"},{"1":"Middlesex County","2":"2219"},{"1":"Pike County","2":"2219"},{"1":"Putnam County","2":"2219"},{"1":"Summit County","2":"2219"},{"1":"York County","2":"2219"},{"1":"Birmingham","2":"1902"},{"1":"Butler County","2":"1902"},{"1":"Crawford County","2":"1902"},{"1":"El Paso County","2":"1902"},{"1":"Erie County","2":"1902"},{"1":"Grant County","2":"1902"},{"1":"Harrison County","2":"1902"},{"1":"Logan County","2":"1902"},{"1":"Randolph County","2":"1902"},{"1":"Richmond County","2":"1902"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="visualizing-distributions" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Visualizing Distributions</h1>
<p>Before we start looking at relationships <em>between</em> variables, we should examine each variable’s underlying distribution. In the next section, we’re going to cover a few graphs that display variable distributions: histograms, density, violin, and ridgeline plots,</p>
<div id="histograms" class="section level2 tabset" number="6.1">
<h2 class="tabset" number="6.1"><span class="header-section-number">6.1</span> Histograms</h2>
<p>A histogram is a special kind of bar graph–it only takes a single continuous variable (in this case, <code>dir_request</code>), and it displays a relative breakdown of the values.</p>
<p>The <code>x</code> axis for the histogram will have the direction requests, and the <code>y</code> variable will display a count of the values.</p>
<pre class="r"><code>lab_hist &lt;- labs(x = &quot;Apple directions requests&quot;,
                 y = &quot;Count&quot;,
     title = &quot;Distribution of Direction Requests&quot;,
     subtitle = &quot;source: https://covid19.apple.com/mobility&quot;)</code></pre>
<div id="exercise" class="section level3" number="6.1.1">
<h3 number="6.1.1"><span class="header-section-number">6.1.1</span> exercise</h3>
<p>Create a histogram of direction requests using <code>dir_request</code></p>
<pre class="r"><code>TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = ____________)) + 
  lab_hist</code></pre>
</div>
<div id="solution" class="section level3" number="6.1.2">
<h3 number="6.1.2"><span class="header-section-number">6.1.2</span> solution</h3>
<p>See blow:</p>
<pre class="r"><code>TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = dir_request)) + 
  lab_hist</code></pre>
<p><img src="img/geom_histogram-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="adjusting-y-axes" class="section level2 tabset" number="6.2">
<h2 class="tabset" number="6.2"><span class="header-section-number">6.2</span> Adjusting Y Axes</h2>
<p>We can see the <code>y</code> axis of the histogram is in scientific notation. This might be hard for some audiences to interpret, so we will change this to use the whole number with commas with the <a href="https://scales.r-lib.org/"><code>scales</code> package</a>.</p>
<div id="exercise-1" class="section level3" number="6.2.1">
<h3 number="6.2.1"><span class="header-section-number">6.2.1</span> exercise</h3>
<p>Add the <code>scales::comma</code> value to the <code>scale_y_continuous()</code> function.</p>
<pre class="r"><code>library(scales)
TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = dir_request)) + 
  scale_y_continuous(labels = __________) +
  lab_hist</code></pre>
</div>
<div id="solution-1" class="section level3" number="6.2.2">
<h3 number="6.2.2"><span class="header-section-number">6.2.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>library(scales)
TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = dir_request)) + 
  scale_y_continuous(labels = scales::comma) +
  lab_hist</code></pre>
<p><img src="img/scales-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="histogram-shape" class="section level2 tabset" number="6.3">
<h2 class="tabset" number="6.3"><span class="header-section-number">6.3</span> Histogram Shape</h2>
<p>We can control the shape of the histogram with the <code>bins</code> argument. The default is <code>30</code>.</p>
<div id="exercie" class="section level3" number="6.3.1">
<h3 number="6.3.1"><span class="header-section-number">6.3.1</span> exercie</h3>
<p>Set <code>bins</code> to <code>15</code>.</p>
<pre class="r"><code>TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = dir_request), bins = __) + 
  scale_y_continuous(labels = scales::comma) +
  lab_hist</code></pre>
</div>
<div id="solution-2" class="section level3" number="6.3.2">
<h3 number="6.3.2"><span class="header-section-number">6.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = dir_request), bins = 15) + 
  scale_y_continuous(labels = scales::comma) +
  lab_hist</code></pre>
<p><img src="img/bins-15-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="exercise-2" class="section level3" number="6.3.3">
<h3 number="6.3.3"><span class="header-section-number">6.3.3</span> exercise</h3>
<p>Set <code>bins</code> to <code>45</code> and assign it to <code>gg_hist45</code>.</p>
<pre class="r"><code>TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = dir_request), bins = __) + 
  scale_y_continuous(labels = scales::comma) +
  lab_hist -&gt; _____________</code></pre>
</div>
<div id="solution-3" class="section level3" number="6.3.4">
<h3 number="6.3.4"><span class="header-section-number">6.3.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TidyApple %&gt;% ggplot() + 
  geom_histogram(aes(x = dir_request), bins = 45) + 
  scale_y_continuous(labels = scales::comma) +
  lab_hist -&gt; gg_hist45</code></pre>
<p><img src="img/gg_hist45-show-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="density-plots" class="section level2 tabset" number="6.4">
<h2 class="tabset" number="6.4"><span class="header-section-number">6.4</span> Density Plots</h2>
<p>What if we want to see how a continuous variable is distributed across a categorical variable? We did this in the <a href="https://mjfrigaard.github.io/data-viz-intro/Index.html#87">previous lesson with a boxplot</a>.</p>
<p>Density plots come in handy here (so do <code>geom_boxplot()</code>s!). Read more about the density geom <a href="https://ggplot2.tidyverse.org/reference/geom_density.html">here</a>.</p>
<p>We are going to create the graph labels so we know what to expect when we build our graph.</p>
<p>We want to see the distribution of the directions request, filled by the levels of transportation type.</p>
<pre class="r"><code>lab_density &lt;- labs(x = &quot;Apple directions requests&quot;,
                    fill = &quot;Transit Type&quot;,
     title = &quot;Distribution of Direction Requests vs. Transportation Type&quot;,
     subtitle = &quot;source: https://covid19.apple.com/mobility&quot;)</code></pre>
<p>Now we build the density plot, passing the variables so they match our labels above.</p>
<div id="exercise-3" class="section level3" number="6.4.1">
<h3 number="6.4.1"><span class="header-section-number">6.4.1</span> exercise</h3>
<p>Create a density plot of direction requests colored by the type of transportation.</p>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  geom_density(aes(x = __________, fill = __________)) + 
  lab_density</code></pre>
</div>
<div id="solution-4" class="section level3" number="6.4.2">
<h3 number="6.4.2"><span class="header-section-number">6.4.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  geom_density(aes(x = dir_request, fill = trans_type)) + 
  lab_density</code></pre>
<p><img src="img/density-sol-1.png" width="100%" height="100%" /></p>
<p><em>One drawback to density plots is the <code>y</code> axis can be hard to interpret</em></p>
</div>
<div id="exercise-4" class="section level3" number="6.4.3">
<h3 number="6.4.3"><span class="header-section-number">6.4.3</span> exercise</h3>
<p>Adjust the overlapping densities by setting <code>alpha</code> to <code>1/3</code>. Assign this plot to <code>gg_density</code>.</p>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  geom_density(aes(x = dir_request, fill = trans_type), 
               alpha = __________) + 
  
  lab_density -&gt; __________</code></pre>
</div>
<div id="solution-5" class="section level3" number="6.4.4">
<h3 number="6.4.4"><span class="header-section-number">6.4.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  geom_density(aes(x = dir_request, fill = trans_type), 
               alpha = 1/3) + 
  lab_density -&gt; gg_density

gg_density</code></pre>
<p><img src="img/density-alpha-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="ridgeline-plots" class="section level2 tabset" number="6.5">
<h2 class="tabset" number="6.5"><span class="header-section-number">6.5</span> Ridgeline Plots</h2>
<p>Another option is a ridgeline plot (from the <code>ggridges</code> package). These display multiple densities.</p>
<pre class="r"><code>lab_ridges &lt;- labs(
     title = &quot;Direction Requests by Transportation Type&quot;,
     subtitle = &quot;source: https://covid19.apple.com/mobility&quot;,
     fill = &quot;Transit type&quot;,
     x = &quot;Apple directions requests&quot;,
     y = &quot;Transportation Types&quot;)</code></pre>
<pre class="r"><code>library(ggridges)
TidyApple %&gt;%  
  ggplot() + 
  geom_density_ridges(aes(x = dir_request, 
                          y = trans_type, 
                          fill = trans_type), 
                      alpha = 1/5) + 
  lab_ridges</code></pre>
<p><img src="img/geom_density_ridges-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="violin-plots" class="section level2 tabset" number="6.6">
<h2 class="tabset" number="6.6"><span class="header-section-number">6.6</span> Violin Plots</h2>
<p>Another alternative to the density plot is the violin plot.</p>
<div id="exercise-5" class="section level3" number="6.6.1">
<h3 number="6.6.1"><span class="header-section-number">6.6.1</span> exercise</h3>
<ul>
<li>assign <code>"Apple directions requests"</code> to the <code>x</code> axis</li>
<li>assign <code>"Transit Type"</code> to the <code>y</code> axis</li>
</ul>
<pre class="r"><code>lab_violin &lt;- labs(x = _________________________,
                    y = _________________________,
                   fill = &quot;Transit Type&quot;,
     title = &quot;Distribution of Direction Requests vs. Transportation Type&quot;,
     subtitle = &quot;source: https://covid19.apple.com/mobility&quot;)</code></pre>
</div>
<div id="solution-6" class="section level3" number="6.6.2">
<h3 number="6.6.2"><span class="header-section-number">6.6.2</span> solution</h3>
<pre class="r"><code>lab_violin &lt;- labs(x = &quot;Apple directions requests&quot;,
                   y = &quot;Transit Type&quot;,
                   fill = &quot;Transit Type&quot;,
     title = &quot;Distribution of Direction Requests vs. Transportation Type&quot;,
     subtitle = &quot;source: https://covid19.apple.com/mobility&quot;)</code></pre>
</div>
<div id="exercise-6" class="section level3" number="6.6.3">
<h3 number="6.6.3"><span class="header-section-number">6.6.3</span> exercise</h3>
<p>Add a <code>geom_violin()</code> to the code below:</p>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  ____________(aes(y = dir_request, x = trans_type, 
                  fill = trans_type)) + 
  lab_violin</code></pre>
</div>
<div id="solution-7" class="section level3" number="6.6.4">
<h3 number="6.6.4"><span class="header-section-number">6.6.4</span> solution</h3>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  geom_violin(aes(y = dir_request, x = trans_type, 
                  fill = trans_type)) + 
  lab_violin</code></pre>
<p><img src="img/geom_violin-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="exercise-7" class="section level3" number="6.6.5">
<h3 number="6.6.5"><span class="header-section-number">6.6.5</span> exercise</h3>
<p>The great thing about <code>ggplot2</code>s layered syntax, is that we can add <code>geoms</code> with similar aesthetics to the same graph! For example, we can see how <code>geom_violin</code>s and <code>geom_boxplot</code>s are related by adding a <code>geom_boxplot()</code> layer to the graph above.</p>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  geom_violin(aes(y = dir_request, x = trans_type, 
                  fill = trans_type), alpha = 1/5) + 
  ___________(aes(y = dir_request, x = trans_type, 
                   color = trans_type)) + 
  lab_violin</code></pre>
</div>
<div id="solution-8" class="section level3" number="6.6.6">
<h3 number="6.6.6"><span class="header-section-number">6.6.6</span> solution</h3>
<p>Note we set the <code>alpha</code> to <code>1/5</code> for the <code>geom_violin()</code>, and the <code>color</code> to <code>trans_type</code> for the <code>geom_boxplot()</code>.</p>
<pre class="r"><code>TidyApple %&gt;% 
  ggplot() +
  geom_violin(aes(y = dir_request, x = trans_type, 
                  fill = trans_type), alpha = 1/5) + 
  geom_boxplot(aes(y = dir_request, x = trans_type, 
                   color = trans_type)) + 
  lab_violin</code></pre>
<p><img src="img/geom_violin-boxplot-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
</div>
<div id="visualizing-trends" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Visualizing Trends</h1>
<p>We’ve seen the distribution of <code>dir_request</code>, and how it varies across <code>trans_type</code>.</p>
<p>Now we’ll look at how the relationship between these two variables varies over in a subset of US cities and across a specific <code>date</code> range.</p>
<div id="focus-on-us-cities" class="section level2 tabset" number="7.1">
<h2 class="tabset" number="7.1"><span class="header-section-number">7.1</span> Focus on US Cities</h2>
<p>We’ll start by narrowing down the data by filtering to only US cities.</p>
<div id="exercise-8" class="section level3" number="7.1.1">
<h3 number="7.1.1"><span class="header-section-number">7.1.1</span> exercise</h3>
<p>Filter the <code>geo_type</code> to <code>"city"</code> and the <code>country</code> to <code>"United States"</code>, and pass the <code>date</code> variable to <code>skimr::skim()</code></p>
<pre class="r"><code>TidyApple %&gt;% 
  filter(geo_type == ___________ &amp;
              country == ___________) %&gt;% 
                # use skimr to check date
                skimr::skim(___________)</code></pre>
</div>
<div id="solution-9" class="section level3" number="7.1.2">
<h3 number="7.1.2"><span class="header-section-number">7.1.2</span> solution</h3>
<p>Here we reduce the dataset to only cities in the US, and we check the <code>date</code> range with <code>skimr::skim()</code>. If this looks OK, we assign to <code>USCities</code></p>
<pre class="r"><code>TidyApple %&gt;% 
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;) %&gt;% 
                # use skimr to check date
                skimr::skim(date)</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">99538</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-01-13</td>
<td align="left">2020-11-24</td>
<td align="left">2020-06-19</td>
<td align="right">317</td>
</tr>
</tbody>
</table>
<pre class="r"><code>TidyApple %&gt;% 
  filter(geo_type == &quot;city&quot; &amp;
         country == &quot;United States&quot;) -&gt; USCities</code></pre>
</div>
</div>
<div id="updating-labels" class="section level2 tabset" number="7.2">
<h2 class="tabset" number="7.2"><span class="header-section-number">7.2</span> Updating Labels</h2>
<p>We can see this date range is from 2020-01-13 to 2020-11-24.</p>
<div id="exercise-9" class="section level3" number="7.2.1">
<h3 number="7.2.1"><span class="header-section-number">7.2.1</span> exercise</h3>
<p>Use <code>paste0()</code> to combine the first and last <code>date</code> in the filtered <code>USCities</code> dataset.</p>
<pre class="r"><code>paste0(min(______________$____), 
       &quot; through &quot;, 
       max(______________$____))</code></pre>
</div>
<div id="solution-10" class="section level3" number="7.2.2">
<h3 number="7.2.2"><span class="header-section-number">7.2.2</span> solution</h3>
<pre class="r"><code>paste0(min(USCities$date), 
       &quot; through &quot;, 
       max(USCities$date))</code></pre>
<pre><code>## [1] &quot;2020-01-13 through 2020-11-24&quot;</code></pre>
<p>We want to specify this in our labels object (<code>lab_line_update</code>), so we will use the <code>paste0()</code> function to have the labels update every time the data changes.</p>
<pre class="r"><code>labs(x = &quot;Date&quot;,
     y = &quot;Direction Requests&quot;,
     title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
     subtitle = paste0(min(USCities$date), 
                       &quot; through &quot;, 
                       max(USCities$date)),
     caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
     color = &quot;Transit Type&quot;) -&gt; lab_line_update</code></pre>
<p>We’re going to create a line graph of direction requests over time, colored by color.</p>
</div>
<div id="exercise-10" class="section level3" number="7.2.3">
<h3 number="7.2.3"><span class="header-section-number">7.2.3</span> exercise</h3>
<p>Pass the filtered data to the <code>geom_line()</code>, mapping the following variables to their relative aesthetics:</p>
<ul>
<li><code>date</code> to <code>x</code><br />
</li>
<li><code>dir_request</code> to <code>y</code><br />
</li>
<li><code>trans_type</code> to both <code>group</code> and <code>color</code></li>
</ul>
<p>Include <code>lab_line_update</code> to see how the new labels look!</p>
<pre class="r"><code>USCities %&gt;% 
  ggplot() +
  geom_line(aes(x = __________, y = __________, 
             group = __________, color = __________)) + 
  __________</code></pre>
</div>
<div id="solution-11" class="section level3" number="7.2.4">
<h3 number="7.2.4"><span class="header-section-number">7.2.4</span> solution</h3>
<p>Let’s see what happens when we use <code>lab_line_update</code>.</p>
<pre class="r"><code>USCities %&gt;% 
  ggplot() +
  geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type)) + 
  lab_line_update</code></pre>
<p><img src="img/geom-line-us-cities-sol-1.png" width="100%" height="100%" /></p>
<p>The dates updated to the min and max <code>date</code> in <code>USCities</code>.</p>
</div>
</div>
<div id="adjusting-line-size" class="section level2 tabset" number="7.3">
<h2 class="tabset" number="7.3"><span class="header-section-number">7.3</span> Adjusting Line Size</h2>
<p>These lines in this graph are overlapping each other, so we will adjust the <code>size</code> to <code>0.20</code>.</p>
<div id="exercise-11" class="section level3" number="7.3.1">
<h3 number="7.3.1"><span class="header-section-number">7.3.1</span> exercise</h3>
<p>Change the size of the <code>geom_line()</code> (outside of <code>aes()</code>).</p>
<pre class="r"><code>USCities %&gt;% 
  ggplot() +
  geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
            size = ____________) + 
  lab_line01</code></pre>
</div>
<div id="solution-12" class="section level3" number="7.3.2">
<h3 number="7.3.2"><span class="header-section-number">7.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>USCities %&gt;% 
  ggplot() +
  geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
            size = 0.20) + 
  lab_line_update</code></pre>
<p><img src="img/us-cities-line-alpha-sol-1.png" width="100%" height="100%" /></p>
<p>Now the trends are easier to see.</p>
</div>
</div>
<div id="setting-date-range" class="section level2 tabset" number="7.4">
<h2 class="tabset" number="7.4"><span class="header-section-number">7.4</span> Setting Date Range</h2>
<p>We are going to only look at the trends between February and August of 2020, but we’re going to use an alternative method to <code>filter</code> the data and create the labels.</p>
<p>We will create two new objects (<code>start_date</code> and <code>end_date</code>), which we can use to narrow the dates using the <code>filter()</code> function (and anywhere else we need to use this date range).</p>
<p>This method is better than passing the dates as a character (i.e. in quotes), because we would only have to change it in one place. However, the option above makes better use of R functional programming syntax.</p>
<div id="exercise-12" class="section level3" number="7.4.1">
<h3 number="7.4.1"><span class="header-section-number">7.4.1</span> exercise</h3>
<p>Pass the <code>start_date</code> and <code>end_date</code> to the <code>as_date()</code> functions, and take a look at the <code>date</code> variable with <code>skimr::skim()</code> and if it looks correct, assign it to <code>USCitiesFebJul</code></p>
<pre class="r"><code># create date objects
start_date &lt;- &quot;2020-02-01&quot;
end_date &lt;- &quot;2020-08-01&quot;
# check with skimr
TidyApple %&gt;% 
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;, 
                date &gt;= as_date(_____________) &amp; 
                  date &lt;= as_date(_____________)) %&gt;% 
                  skimr::skim(_____________)</code></pre>
</div>
<div id="solution-13" class="section level3" number="7.4.2">
<h3 number="7.4.2"><span class="header-section-number">7.4.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code># create date objects
start_date &lt;- &quot;2020-02-01&quot;
end_date &lt;- &quot;2020-08-01&quot;
# check with skimr
TidyApple %&gt;% 
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;, 
                date &gt;= as_date(start_date) &amp; 
                  date &lt;= as_date(end_date)) -&gt; USCitiesFebJul

USCitiesFebJul %&gt;% 
  skimr::skim(date)</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">57462</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-02-01</td>
<td align="left">2020-08-01</td>
<td align="left">2020-05-02</td>
<td align="right">183</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-13" class="section level3" number="7.4.3">
<h3 number="7.4.3"><span class="header-section-number">7.4.3</span> exercise</h3>
<p>Create the new labels (<code>lab_line_paste</code>) with the <code>paste0()</code> function by passing both <code>start_date</code> and <code>end_date</code>.</p>
<pre class="r"><code>lab_line_paste &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(___________, &quot; through &quot;, ___________),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-14" class="section level3" number="7.4.4">
<h3 number="7.4.4"><span class="header-section-number">7.4.4</span> solution</h3>
<pre class="r"><code>lab_line_paste &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(start_date, &quot; through &quot;, end_date),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
                 color = &quot;Transit Type&quot;)

USCitiesFebJul %&gt;% 
  ggplot() +
  geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
            # make these slightly larger...
            size = 0.30) + 
  lab_line_paste</code></pre>
<p><img src="img/create-lab_line_paste-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
</div>
<div id="adding-text-to-graphs" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Adding Text to Graphs</h1>
<p>We can see there is a gap in the direct request data (this is <a href="https://covid19.apple.com/mobility">documented in the data source</a>).</p>
<blockquote>
<p><em>“Data for May 11-12 is not available and will appear as blank columns in the data set.”</em></p>
</blockquote>
<p>We should communicate this gap with our audience, and we might include a text annotation on the graph so our audience isn’t distracted by the gap.</p>
<p>In the previous lesson, we introduced the <code>ggrepel</code> package to show the points on this graph of top performing pharmaceutical companies.</p>
<p><img src="img/aes-sol-11-1.png" width="70%" height="70%" style="display: block; margin: auto;" /></p>
<p>We’re going to use labels to annotate and highlight US cities between March and June of 2020.</p>
<div id="annotations" class="section level2 tabset" number="8.1">
<h2 class="tabset" number="8.1"><span class="header-section-number">8.1</span> Annotations</h2>
<p>Being able to manually add text and annotations as layers to your graph makes it easier to communicate the nuances of your data to your audience. We are going to start by accounting for the missing data in <code>TidyApple</code>.</p>
<div id="exercise-14" class="section level3" number="8.1.1">
<h3 number="8.1.1"><span class="header-section-number">8.1.1</span> exercise</h3>
<p>Build a dataset from <code>TidyApple</code> that only has US cities, and ranges from March 1, 2020 to June 30, 2020.</p>
<pre class="r"><code>USCitiesMarJun &lt;-  TidyApple %&gt;% 
  filter(geo_type == ___________ &amp;
              country == ___________, 
                date &gt;= as_date(___________) &amp; 
                  date &lt;= as_date(___________)) 

USCitiesMarJun %&gt;% 
                  skimr::skim()</code></pre>
</div>
<div id="solution-15" class="section level3" number="8.1.2">
<h3 number="8.1.2"><span class="header-section-number">8.1.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>USCitiesMarJun &lt;-  TidyApple %&gt;% 
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;, 
                date &gt;= as_date(&quot;2020-03-01&quot;) &amp; 
                  date &lt;= as_date(&quot;2020-07-01&quot;)) 

USCitiesMarJun %&gt;% skimr::skim()</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">38622</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geo_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">39</td>
<td align="right">0</td>
<td align="right">111</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">trans_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sub_region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">39</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-03-01</td>
<td align="left">2020-07-01</td>
<td align="left">2020-05-01</td>
<td align="right">123</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dir_request</td>
<td align="right">628</td>
<td align="right">0.98</td>
<td align="right">82.06</td>
<td align="right">41.11</td>
<td align="right">4.37</td>
<td align="right">50.87</td>
<td align="right">74.38</td>
<td align="right">109.11</td>
<td align="right">525.44</td>
<td align="left">▇▃▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-15" class="section level3" number="8.1.3">
<h3 number="8.1.3"><span class="header-section-number">8.1.3</span> exercise</h3>
<p>We’re going to build labels using the <code>paste0()</code> function. Fill in the appropriate dataset for the <code>min()</code> and <code>max()</code> date.</p>
<pre class="r"><code>lab_annotate &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(min(______________$date), 
                                   &quot; through &quot;, 
                                   max(______________$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-16" class="section level3" number="8.1.4">
<h3 number="8.1.4"><span class="header-section-number">8.1.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_annotate &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(min(USCitiesMarJun$date), 
                                   &quot; through &quot;, 
                                   max(USCitiesMarJun$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="exercise-16" class="section level3" number="8.1.5">
<h3 number="8.1.5"><span class="header-section-number">8.1.5</span> exercise</h3>
<p>The previous code for the graph has been added. We’re going to add the following layers:</p>
<p>Inside <code>coord_cartesian()</code>:</p>
<ul>
<li>map <code>min(USCitiesMarJun$date)</code> and <code>max(USCitiesMarJun$date)</code> inside <code>c()</code> to <code>xlim</code><br />
</li>
<li>map <code>min(USCitiesMarJun$dir_request, na.rm = TRUE)</code> and <code>max(USCitiesMarJun$dir_request, na.rm = TRUE)</code> inside <code>c()</code> to <code>ylim</code></li>
</ul>
<p>Inside the <code># horizontal</code> <code>annotate()</code>:</p>
<ul>
<li>set <code>geom</code> to <code>"segment"</code><br />
</li>
<li>map <code>0.5</code> to <code>size</code><br />
</li>
<li>map <code>"firebrick3"</code> to <code>color</code><br />
</li>
<li>map <code>lubridate::as_date("2020-05-10")</code> to <code>x</code><br />
</li>
<li>map <code>lubridate::as_date("2020-05-13")</code> to <code>xend</code><br />
</li>
<li>map <code>100</code> to <code>y</code> and <code>yend</code></li>
</ul>
<p>Inside the <code># big vertical</code> <code>annotate()</code>:</p>
<ul>
<li>set <code>geom</code> to <code>"segment"</code></li>
<li>map <code>1</code> to <code>size</code><br />
</li>
<li>map <code>"firebrick3"</code> to <code>color</code><br />
</li>
<li>map <code>lubridate::as_date("2020-05-11")</code> to <code>x</code><br />
</li>
<li>map <code>lubridate::as_date("2020-05-11")</code> to <code>xend</code><br />
</li>
<li>map <code>270</code> to <code>y</code> and <code>100</code> to <code>yend</code></li>
</ul>
<p>Inside the <code># text</code> <code>annotate()</code>:</p>
<ul>
<li>set <code>geom</code> to <code>"text"</code></li>
<li>map <code>8</code> to <code>size</code><br />
</li>
<li>map <code>"red"</code> to <code>color</code></li>
<li>map <code>0.5</code> to <code>hjust</code><br />
</li>
<li>map <code>lubridate::as_date("2020-05-07")</code> to <code>x</code><br />
</li>
<li>map <code>280</code> to <code>y</code><br />
</li>
<li>map <code>"Data not available"</code> to <code>label</code></li>
</ul>
<pre class="r"><code>USCitiesMarJun %&gt;% 
    ggplot() +
    geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
             # make these slightly larger...
             size = 0.30) + 
   # coordinate system
   coord_cartesian(xlim = c(_______________, _______________), 
                   
                   ylim = c(_______________, na.rm = __________), 
                            _______________, na.rm = __________))) +
   # horizontal
   annotate(geom = ___________, size = ___________, color = ___________,
                  x = ___________, 
                  xend = ___________,
                  y = ___________, 
                  yend = ___________) + 
    # big vertical 
    annotate(geom = ___________, 
            size = ___________, 
            color = ___________,
            x = ___________, 
            xend = ___________, 
            y = ___________, yend = ___________) + 
    # text
    annotate(geom = &quot;text&quot;,
               size = 8,
               color = &quot;red&quot;, 
               hjust = 0.5, 
               x = lubridate::as_date(&quot;2020-05-07&quot;), 
               y = 280, 
               label = &quot;Data not available&quot;) +

    lab_annotate</code></pre>
</div>
<div id="solution-17" class="section level3" number="8.1.6">
<h3 number="8.1.6"><span class="header-section-number">8.1.6</span> solution</h3>
<pre class="r"><code># plot
USCitiesMarJun %&gt;% 
    ggplot() +
    geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
             # make these slightly larger...
             size = 0.30) + 
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date), 
                            max(USCitiesMarJun$date)), 
                   
                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE), 
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
   # horizontal
   annotate(geom = &quot;segment&quot;, 
            size = 0.5, 
            color = &quot;firebrick3&quot;,
                  x = lubridate::as_date(&quot;2020-05-10&quot;), 
                  xend = lubridate::as_date(&quot;2020-05-13&quot;),
                             y = 100, 
                             yend = 100) + 
    # big vertical 
    annotate(geom = &quot;segment&quot;, 
            size = 1, 
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-11&quot;), 
            xend = lubridate::as_date(&quot;2020-05-11&quot;), 
            y = 270, yend = 100) + 
  
    # text
    annotate(geom = &quot;text&quot;,
               color = &quot;red&quot;, 
               hjust = 0.5, 
               size = 8,
               x = lubridate::as_date(&quot;2020-05-07&quot;), 
               y = 280, 
               label = &quot;Data not available&quot;) +

    lab_annotate</code></pre>
<p><img src="img/coord_cartesian-annotate-text-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="exercise-17" class="section level3" number="8.1.7">
<h3 number="8.1.7"><span class="header-section-number">8.1.7</span> exercise</h3>
<p>Add a second and third vertical <code>segment</code> to create a fence or bracket for the dates with missing data.</p>
<pre class="r"><code># plot
USCitiesMarJun %&gt;% 
    ggplot() +
    geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
             # make these slightly larger...
             size = 0.30) + 
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date), 
                            max(USCitiesMarJun$date)), 
                   
                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE), 
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
   # horizontal
   annotate(geom = &quot;segment&quot;, 
            size = 0.5, 
            color = &quot;firebrick3&quot;,
                  x = lubridate::as_date(&quot;2020-05-10&quot;), 
                  xend = lubridate::as_date(&quot;2020-05-13&quot;),
                             y = 100, 
                             yend = 100) +
    # big vertical 
    annotate(geom = &quot;segment&quot;, 
            size = 1, 
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-11&quot;), 
            xend = lubridate::as_date(&quot;2020-05-11&quot;), 
            y = 270, yend = 100) + 
    # text
    annotate(geom = &quot;text&quot;,
               color = &quot;red&quot;, 
               hjust = 0.5, 
               size = 8,
               x = lubridate::as_date(&quot;2020-05-07&quot;), 
               y = 280, 
               label = &quot;Data not available&quot;) +
   # second vertical 
   annotate(geom = &quot;segment&quot;, 
            size = 0.5, 
            color = &quot;firebrick3&quot;,
            x = _____________________________, 
            xend = _____________________________, 
            y = _____________________________, 
            yend = _____________________________) + 
    # third vertical 
     annotate(geom = &quot;segment&quot;, 
            size = 0.5, 
            color = &quot;firebrick3&quot;,
            x = _____________________________, 
            xend = _____________________________, 
            y = _____________________________, 
            yend = _____________________________) + 
  
   lab_annotate </code></pre>
</div>
<div id="solution-18" class="section level3" number="8.1.8">
<h3 number="8.1.8"><span class="header-section-number">8.1.8</span> solution</h3>
<p>See below:</p>
<pre class="r"><code># plot
USCitiesMarJun %&gt;% 
    ggplot() +
    geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
             # make these slightly larger...
             size = 0.30) + 
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date), 
                            max(USCitiesMarJun$date)), 
                   
                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE), 
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
   # horizontal
   annotate(geom = &quot;segment&quot;, 
            size = 0.5, 
            color = &quot;firebrick3&quot;,
                  x = lubridate::as_date(&quot;2020-05-10&quot;), 
                  xend = lubridate::as_date(&quot;2020-05-13&quot;),
                             y = 100, 
                             yend = 100) +
    # big vertical 
    annotate(geom = &quot;segment&quot;, 
            size = 1, 
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-11&quot;), 
            xend = lubridate::as_date(&quot;2020-05-11&quot;), 
            y = 270, yend = 100) + 
    # text
    annotate(geom = &quot;text&quot;,
               color = &quot;red&quot;, 
               hjust = 0.5, 
               size = 8,
               x = lubridate::as_date(&quot;2020-05-07&quot;), 
               y = 280, 
               label = &quot;Data not available&quot;) +
   # second vertical 
   annotate(geom = &quot;segment&quot;, 
            size = 0.5, 
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-10&quot;), 
            xend = lubridate::as_date(&quot;2020-05-10&quot;), 
            y = 100, yend = 90) + 
    # third vertical 
     annotate(geom = &quot;segment&quot;, 
            size = 0.5, 
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-13&quot;), 
            xend = lubridate::as_date(&quot;2020-05-13&quot;), 
            y = 100, yend = 90) + 
  
   lab_annotate </code></pre>
<p><img src="img/coord_cartesian-annotate-comp-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="plotting-area" class="section level2 tabset" number="8.2">
<h2 class="tabset" number="8.2"><span class="header-section-number">8.2</span> Plotting area</h2>
<p>Another option is to use <code>geom_rect()</code> to black out the missing data.</p>
<pre class="r"><code># plot
USCitiesMarJun %&gt;% 
    ggplot() +
    geom_line(aes(x = date, y = dir_request, 
             group = trans_type, color = trans_type), 
             # make these slightly larger...
             size = 0.30) + 
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date), 
                            max(USCitiesMarJun$date)), 
                   
                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE), 
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
  geom_rect(xmin = lubridate::as_date(&quot;2020-05-10&quot;), 
            xmax = lubridate::as_date(&quot;2020-05-12&quot;), 
            ymin = -Inf, 
            ymax = Inf, 
            color = NA) + 
  geom_text(x = as.Date(&quot;2020-05-11&quot;), 
            y = 100, label = &quot;Data Not Available&quot;, 
            angle = 90, color = &quot;white&quot;) +
  lab_annotate</code></pre>
<p><img src="img/geom_rect-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="labeling-values" class="section level2 tabset" number="8.3">
<h2 class="tabset" number="8.3"><span class="header-section-number">8.3</span> Labeling Values</h2>
<p><strong>Max Driving Requests</strong></p>
<p>The code below creates a subset of the data (<code>TopUSCities</code>). We will use this to add the labels.</p>
<pre class="r"><code>TopUSCities &lt;- TidyApple %&gt;% 
  filter(country == &quot;United States&quot; &amp; 
           region %in% c(&quot;New York City&quot;, &quot;Los Angeles&quot;, 
                         &quot;Chicago&quot;, &quot;Houston&quot;, &quot;Phoenix&quot;)) 
TopUSCities</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-13","7":"100.00"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-14","7":"103.68"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-15","7":"104.45"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-16","7":"108.72"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-17","7":"132.80"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-18","7":"113.44"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-19","7":"87.48"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-20","7":"100.24"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-21","7":"101.30"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-22","7":"100.51"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-23","7":"104.47"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-24","7":"121.92"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-25","7":"118.55"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-26","7":"85.17"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-27","7":"93.81"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-28","7":"97.36"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-29","7":"98.96"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-30","7":"103.79"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-31","7":"124.37"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-01","7":"122.53"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-02","7":"85.96"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-03","7":"94.62"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-04","7":"97.39"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-05","7":"102.86"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-06","7":"103.66"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-07","7":"117.63"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-08","7":"124.27"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-09","7":"88.41"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-10","7":"98.78"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-11","7":"105.64"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-12","7":"108.54"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-13","7":"115.99"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-14","7":"147.32"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-15","7":"141.24"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-16","7":"111.31"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-17","7":"111.07"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-18","7":"104.69"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-19","7":"105.82"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-20","7":"110.84"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-21","7":"132.55"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-22","7":"138.50"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-23","7":"100.83"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-24","7":"99.41"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-25","7":"100.35"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-26","7":"103.39"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-27","7":"114.33"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-28","7":"139.02"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-29","7":"142.31"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-01","7":"105.39"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-02","7":"105.25"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-03","7":"108.28"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-04","7":"110.71"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-05","7":"116.43"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-06","7":"137.62"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-07","7":"144.91"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-08","7":"107.11"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-09","7":"105.68"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-10","7":"109.76"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-11","7":"107.34"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-12","7":"105.61"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="exercise-18" class="section level3" number="8.3.1">
<h3 number="8.3.1"><span class="header-section-number">8.3.1</span> exercise</h3>
<p>Create <code>MaxUSCitiesDriving</code> by filtering <code>trans_type</code>, grouping on the <code>region</code> variable, and using <code>dplyr::slice_max()</code> to get the top value in <code>dir_request</code>.</p>
<pre class="r"><code>TopUSCities %&gt;% 
  filter(trans_type == __________) %&gt;% 
  group_by(__________) %&gt;% 
  slice_max(dir_request) %&gt;% 
  ungroup() -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving</code></pre>
</div>
<div id="solution-19" class="section level3" number="8.3.2">
<h3 number="8.3.2"><span class="header-section-number">8.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  filter(trans_type == &quot;driving&quot;) %&gt;% 
  group_by(region) %&gt;% 
  slice_max(dir_request) %&gt;% 
  ungroup() -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-07-17","7":"166.11"},{"1":"city","2":"Houston","3":"driving","4":"Texas","5":"United States","6":"2020-02-14","7":"146.20"},{"1":"city","2":"Los Angeles","3":"driving","4":"California","5":"United States","6":"2020-02-14","7":"152.08"},{"1":"city","2":"New York City","3":"driving","4":"New York","5":"United States","6":"2020-09-04","7":"152.09"},{"1":"city","2":"Phoenix","3":"driving","4":"Arizona","5":"United States","6":"2020-02-29","7":"142.68"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-19" class="section level3" number="8.3.3">
<h3 number="8.3.3"><span class="header-section-number">8.3.3</span> exercise</h3>
<p>Create graph labels:</p>
<ul>
<li><p>assign <code>"Peak Driving Direction Requests in Largest US Cities"</code> to <code>title</code></p></li>
<li><p>assign <code>"Max Driving Direction Requests &amp; Date"</code> to <code>subtitle</code></p></li>
</ul>
<pre class="r"><code>lab_line_max_drivers &lt;- labs(
                 x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;_________________________________&quot;,
                 subtitle = paste0(min(___________$date), 
                                   &quot; through &quot;, 
                                   max(___________$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-20" class="section level3" number="8.3.4">
<h3 number="8.3.4"><span class="header-section-number">8.3.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_line_max_drivers &lt;- labs(
                 x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Peak Driving Direction Requests in Largest US Cities&quot;,
                 subtitle = paste0(min(TopUSCities$date), 
                                   &quot; through &quot;, 
                                   max(TopUSCities$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="exercise-20" class="section level3" number="8.3.5">
<h3 number="8.3.5"><span class="header-section-number">8.3.5</span> exercise</h3>
<p>Create <code>max_driving_labels</code> using <code>paste0()</code> with <code>region</code> and <code>date</code>.</p>
<pre class="r"><code>MaxUSCitiesDriving %&gt;% 
  mutate(
    max_driving_labels = paste0(______, &quot;, &quot;, ______)) -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving %&gt;% 
  select(max_driving_labels)</code></pre>
</div>
<div id="solution-21" class="section level3" number="8.3.6">
<h3 number="8.3.6"><span class="header-section-number">8.3.6</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>MaxUSCitiesDriving %&gt;% 
  mutate(max_driving_labels = paste0(region, &quot;, &quot;, date)) -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving %&gt;% 
  select(max_driving_labels)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["max_driving_labels"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"Chicago, 2020-07-17"},{"1":"Houston, 2020-02-14"},{"1":"Los Angeles, 2020-02-14"},{"1":"New York City, 2020-09-04"},{"1":"Phoenix, 2020-02-29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-21" class="section level3" number="8.3.7">
<h3 number="8.3.7"><span class="header-section-number">8.3.7</span> exercise</h3>
<p>Create a line plot, assigning the following values in <code>geom_label_repel()</code>:</p>
<ul>
<li>set the <code>data</code> argument to <code>MaxUSCitiesDriving</code></li>
</ul>
<p>Inside the <code>aes()</code>:</p>
<ul>
<li>map <code>label</code> to <code>max_driving_labels</code></li>
</ul>
<p>Outside the <code>aes()</code></p>
<ul>
<li>map <code>color</code> to <code>"red"</code><br />
</li>
<li>map <code>size</code> to <code>3</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;% 
    ggplot() + 
    geom_line(aes(x = date, y = dir_request, 
                  group = trans_type, 
                  color = trans_type), 
                  # make these slightly smaller again...
                  size = 0.15) + 
    geom_label_repel(data = _____________,
              aes(x = date, y = dir_request, 
                  label = _____________), 
                  # set color and size...
                  color = _____, 
                  size = _) + 
  lab_line_max_drivers</code></pre>
</div>
<div id="solution-22" class="section level3" number="8.3.8">
<h3 number="8.3.8"><span class="header-section-number">8.3.8</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
    ggplot() + 
    geom_line(aes(x = date, y = dir_request, 
                  group = trans_type, 
                  color = trans_type), 
                  # make these slightly smaller again...
                  size = 0.15) + 
    geom_label_repel(data = MaxUSCitiesDriving,
              aes(x = date, y = dir_request, 
                  label = max_driving_labels), 
                  # set color and size...
                  color = &quot;red&quot;, 
                  size = 3) + 
  lab_line_max_drivers</code></pre>
<p><img src="img/label-plot-sol-01-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="labeling-values-2" class="section level2 tabset" number="8.4">
<h2 class="tabset" number="8.4"><span class="header-section-number">8.4</span> Labeling Values 2</h2>
<p><strong>Min Walking Requests</strong></p>
<p>We are going to repeat the process above, but use the minimum value for walking direction requests.</p>
<div id="exercise-22" class="section level3" number="8.4.1">
<h3 number="8.4.1"><span class="header-section-number">8.4.1</span> exercise</h3>
<ul>
<li><code>filter()</code> the <code>trans_type</code> to <code>"walking"</code><br />
</li>
<li><code>group_by()</code> the <code>region</code><br />
</li>
<li>use <code>slice_min()</code> to get the minimum value for <code>dir_request</code></li>
<li>Assign to <code>MinUSCitiesWalking</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;% 
  filter(________ == ________) %&gt;% 
  group_by(________) %&gt;% 
  slice_min(dir_request) %&gt;% 
  ungroup() -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
</div>
<div id="solution-23" class="section level3" number="8.4.2">
<h3 number="8.4.2"><span class="header-section-number">8.4.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  filter(trans_type == &quot;walking&quot;) %&gt;% 
  group_by(region) %&gt;% 
  slice_min(dir_request) %&gt;% 
  ungroup() -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"city","2":"Chicago","3":"walking","4":"Illinois","5":"United States","6":"2020-03-22","7":"30.86"},{"1":"city","2":"Houston","3":"walking","4":"Texas","5":"United States","6":"2020-04-12","7":"45.96"},{"1":"city","2":"Los Angeles","3":"walking","4":"California","5":"United States","6":"2020-04-12","7":"31.73"},{"1":"city","2":"New York City","3":"walking","4":"New York","5":"United States","6":"2020-03-29","7":"18.23"},{"1":"city","2":"Phoenix","3":"walking","4":"Arizona","5":"United States","6":"2020-04-12","7":"38.57"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-23" class="section level3" number="8.4.3">
<h3 number="8.4.3"><span class="header-section-number">8.4.3</span> exercise</h3>
<ul>
<li>assign <code>"Lowest Walking Direction Requests in Largest US Cities"</code> to <code>title</code></li>
</ul>
<pre class="r"><code>lab_line_min_walking &lt;- labs(
               x = &quot;Date&quot;,
               y = &quot;Direction Requests&quot;,
               title = &quot;__________________________________________&quot;,
               subtitle = paste0(min(___________$date), 
                                   &quot; through &quot;, 
                                 max(___________$date)),
               caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
               color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-24" class="section level3" number="8.4.4">
<h3 number="8.4.4"><span class="header-section-number">8.4.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_line_min_walking &lt;- labs(
               x = &quot;Date&quot;,
               y = &quot;Direction Requests&quot;,
               title = &quot;Lowest Walking Direction Requests in Largest US Cities&quot;,
               subtitle = paste0(min(TopUSCities$date), 
                                   &quot; through &quot;, 
                                 max(TopUSCities$date)),
               caption = &quot;source: https://covid19.apple.com/mobility&quot;, 
               color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="exercise-24" class="section level3" number="8.4.5">
<h3 number="8.4.5"><span class="header-section-number">8.4.5</span> exercise</h3>
<p>Create <code>min_walking_labels</code> using <code>paste0()</code> with <code>region</code> and <code>date</code></p>
<pre class="r"><code>MinUSCitiesWalking %&gt;% 
  mutate(min_walking_labels = paste0(_____, &quot;, &quot;, _____)) -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
</div>
<div id="solution-25" class="section level3" number="8.4.6">
<h3 number="8.4.6"><span class="header-section-number">8.4.6</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>MinUSCitiesWalking %&gt;% 
  mutate(min_walking_labels = paste0(region, &quot;, &quot;, date)) -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["min_walking_labels"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"city","2":"Chicago","3":"walking","4":"Illinois","5":"United States","6":"2020-03-22","7":"30.86","8":"Chicago, 2020-03-22"},{"1":"city","2":"Houston","3":"walking","4":"Texas","5":"United States","6":"2020-04-12","7":"45.96","8":"Houston, 2020-04-12"},{"1":"city","2":"Los Angeles","3":"walking","4":"California","5":"United States","6":"2020-04-12","7":"31.73","8":"Los Angeles, 2020-04-12"},{"1":"city","2":"New York City","3":"walking","4":"New York","5":"United States","6":"2020-03-29","7":"18.23","8":"New York City, 2020-03-29"},{"1":"city","2":"Phoenix","3":"walking","4":"Arizona","5":"United States","6":"2020-04-12","7":"38.57","8":"Phoenix, 2020-04-12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-25" class="section level3" number="8.4.7">
<h3 number="8.4.7"><span class="header-section-number">8.4.7</span> exercise</h3>
<p>Create a line plot, assigning the following values in <code>geom_label_repel()</code>:</p>
<ul>
<li>set <code>data</code> to <code>MinUSCitiesWalking</code></li>
</ul>
<p>Inside <code>aes()</code>:</p>
<ul>
<li>map <code>min_walking_labels</code> to <code>label</code></li>
</ul>
<p>Outside <code>aes()</code>:</p>
<ul>
<li>map <code>"blue"</code> to <code>color</code><br />
</li>
<li>map <code>3</code> to <code>size</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;% 
    ggplot() + 
    geom_line(aes(x = date, y = dir_request, 
                  group = trans_type, 
                  color = trans_type), 
                  # make these slightly smaller again...
                  size = 0.15) + 
    geom_label_repel(data = ____________,
              aes(x = date, y = dir_request, 
                  label = ____________), 
                  # set color and size...
                  color = _______, 
                  size = _) + 
  lab_line_min_walking</code></pre>
</div>
<div id="solution-26" class="section level3" number="8.4.8">
<h3 number="8.4.8"><span class="header-section-number">8.4.8</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
    ggplot() + 
    geom_line(aes(x = date, y = dir_request, 
                  group = trans_type, 
                  color = trans_type), 
                  # make these slightly smaller again...
                  size = 0.15) + 
    geom_label_repel(data = MinUSCitiesWalking,
              aes(x = date, y = dir_request, 
                  label = min_walking_labels), 
                  # set color and size...
                  color = &quot;blue&quot;, 
                  size = 3) + 
  lab_line_min_walking</code></pre>
<p><img src="img/label-plot-sol-02-1.png" width="100%" height="100%" /></p>
</div>
</div>
</div>
<div id="reference-lines" class="section level1" number="9">
<h1 number="9"><span class="header-section-number">9</span> Reference lines</h1>
<p>We’re going to focus on the top 8 cites according to their <a href="https://en.wikipedia.org/wiki/List_of_United_States_cities_by_population">population</a> (the date of this writing is <code>2020-11-26</code>).</p>
<div id="top-cities" class="section level2 tabset" number="9.1">
<h2 class="tabset" number="9.1"><span class="header-section-number">9.1</span> Top Cities</h2>
<p><strong>Top Cities</strong></p>
<p>We’re going to introduce another <code>filter</code>ing method in this section to create the <code>TopUSCities</code> dataset.</p>
<div id="exercise-26" class="section level3" number="9.1.1">
<h3 number="9.1.1"><span class="header-section-number">9.1.1</span> exercise</h3>
<p>Store top eight cities in the <code>focus_on</code> vector and use it to filter the <code>TidyApple</code> dataset.</p>
<pre class="r"><code>focus_on &lt;- c(&quot;New York City&quot;, &quot;Los Angeles&quot;, 
                       &quot;Chicago&quot;, &quot;Houston&quot;, 
                       &quot;Phoenix&quot;, &quot;Philadelphia&quot;, 
                       &quot;San Antonio&quot;, &quot;San Diego&quot;)

TopUSCities &lt;- TidyApple %&gt;% 
  filter(region %in% _____________)

TopUSCities %&gt;% glimpse(60)</code></pre>
</div>
<div id="solution-27" class="section level3" number="9.1.2">
<h3 number="9.1.2"><span class="header-section-number">9.1.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>focus_on &lt;- c(&quot;New York City&quot;, &quot;Los Angeles&quot;, 
              &quot;Chicago&quot;, &quot;Houston&quot;, 
              &quot;Phoenix&quot;, &quot;Philadelphia&quot;, 
              &quot;San Antonio&quot;, &quot;San Diego&quot;)

TopUSCities &lt;- TidyApple %&gt;% 
  filter(region %in% focus_on)

TopUSCities %&gt;% glimpse(60)</code></pre>
<pre><code>## Rows: 7,608
## Columns: 7
## $ geo_type    &lt;chr&gt; &quot;city&quot;, &quot;city&quot;, &quot;city&quot;, &quot;city&quot;, &quot;city…
## $ region      &lt;chr&gt; &quot;Chicago&quot;, &quot;Chicago&quot;, &quot;Chicago&quot;, &quot;Chi…
## $ trans_type  &lt;chr&gt; &quot;driving&quot;, &quot;driving&quot;, &quot;driving&quot;, &quot;dri…
## $ sub_region  &lt;chr&gt; &quot;Illinois&quot;, &quot;Illinois&quot;, &quot;Illinois&quot;, &quot;…
## $ country     &lt;chr&gt; &quot;United States&quot;, &quot;United States&quot;, &quot;Un…
## $ date        &lt;date&gt; 2020-01-13, 2020-01-14, 2020-01-15, …
## $ dir_request &lt;dbl&gt; 100.00, 103.68, 104.45, 108.72, 132.8…</code></pre>
</div>
<div id="exercise-27" class="section level3" number="9.1.3">
<h3 number="9.1.3"><span class="header-section-number">9.1.3</span> exercise</h3>
<p><strong>Graph Labels</strong></p>
<p>We’re going to place <code>date</code> on the <code>x</code> axis, and <code>dir_request</code> on the <code>y</code>. The <code>tite</code> will reflect a general description of what we’re expecting to see, and we’ll list the cities in the <code>subtitle</code>. <code>color</code> will be used to give a better description than <code>trans_type</code>.</p>
<p>Fill in names for the <code>x</code>, <code>y</code>, and <code>color</code>.</p>
<pre class="r"><code>lab_top_cities &lt;- labs(x = _____, y  = __________, 
     title = &quot;Trends of Relative Activity in Selected US Cities&quot;,
     subtitle = &quot;NY, LA, CH, HOU, PHA, PHL, SATX, SD&quot;, 
     color = _________)</code></pre>
</div>
<div id="solution-28" class="section level3" number="9.1.4">
<h3 number="9.1.4"><span class="header-section-number">9.1.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_top_cities &lt;- labs(x = &quot;Date&quot;, y  = &quot;Direction Requests&quot;, 
     title = &quot;Trends of Relative Activity in Selected US Cities&quot;,
     subtitle = &quot;NY, LA, CH, HOU, PHA, PHL, SATX, SD&quot;, 
     color = &quot;Type&quot;)</code></pre>
</div>
</div>
<div id="set-global-aes" class="section level2 tabset" number="9.2">
<h2 class="tabset" number="9.2"><span class="header-section-number">9.2</span> Set Global <code>aes()</code></h2>
<p>We’re going to set the global graph aesthetics inside <code>ggplot(aes())</code> using our labels as a guide. This will serve as a base layer for us to add our reference line to!</p>
<div id="exercise-28" class="section level3" number="9.2.1">
<h3 number="9.2.1"><span class="header-section-number">9.2.1</span> exercise</h3>
<p><strong>Global <code>aes()</code></strong></p>
<ul>
<li><p>Map <code>trans_type</code> to <code>group</code> and <code>color</code></p></li>
<li><p>Also add a <code>geom_line()</code> layer with the <code>size</code> set to <code>0.1</code> (not inside the <code>aes()</code>!)</p></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             _____ = __________, 
             _____ = __________)) + 
  ____________(_____ = ___) + 
  lab_top_cities</code></pre>
</div>
<div id="solution-29" class="section level3" number="9.2.2">
<h3 number="9.2.2"><span class="header-section-number">9.2.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  lab_top_cities</code></pre>
<p><img src="img/TopUSCities-geom_line-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="reference-line-layer" class="section level2 tabset" number="9.3">
<h2 class="tabset" number="9.3"><span class="header-section-number">9.3</span> Reference Line Layer</h2>
<p>The documentation for the data tells us each <code>dir_request</code> has a baseline value of <code>100</code>. We’re going to add this as a reference line on the graph using <code>ggplot2::geom_hline()</code>.</p>
<div id="exercise-29" class="section level3" number="9.3.1">
<h3 number="9.3.1"><span class="header-section-number">9.3.1</span> exercise</h3>
<p>The <code>geom_hline()</code> function takes <code>yintercept</code>, <code>size</code>, and <code>color</code> arguments.</p>
<ul>
<li>use our baseline value of <code>100</code> as the <code>yintercept</code><br />
</li>
<li>set the <code>size</code> to <code>0.2</code></li>
<li>make the <code>color</code> of this line <code>"gray20"</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) +
  geom_line(size = 0.1) + 
  # add reference line
  geom_hline(yintercept = ___, size = ___, color = _______) +
  lab_top_cities</code></pre>
</div>
<div id="solution-30" class="section level3" number="9.3.2">
<h3 number="9.3.2"><span class="header-section-number">9.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  lab_top_cities</code></pre>
<p><img src="img/geom_hline-sol-1.png" width="100%" height="100%" /></p>
<p>Reference lines are helpful when we want to examine trends in relation to a particular value.</p>
</div>
</div>
</div>
<div id="advanced-facets" class="section level1" number="10">
<h1 number="10"><span class="header-section-number">10</span> Advanced Facets</h1>
<p>In the previous lesson, we introduced the <code>facet_wrap()</code> function for viewing the relationship between two variables across the levels of a categorical variable. In the next section, we’re going to show how faceting can be used to explore ‘small multiples’ in a dataset with variation across multiple levels.</p>
<div id="facet_wrap" class="section level2 tabset" number="10.1">
<h2 class="tabset" number="10.1"><span class="header-section-number">10.1</span> <code>facet_wrap()</code></h2>
<p>Now that we have a graph we can use to compare the <code>8</code> cities, we will use <code>facet_wrap</code> to create a subplot for each level of <code>region</code>.</p>
<div id="exercise-30" class="section level3" number="10.1.1">
<h3 number="10.1.1"><span class="header-section-number">10.1.1</span> exercise</h3>
<p>Fill in the <code>facet_wrap()</code> (note the use of the <code>~</code>) function with <code>region</code> and set the <code>ncol</code> to <code>2</code>.</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(~ _______,  ncol = _) + 
  lab_top_cities</code></pre>
</div>
<div id="solution-31" class="section level3" number="10.1.2">
<h3 number="10.1.2"><span class="header-section-number">10.1.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(~ region,  ncol = 2) + 
  lab_top_cities</code></pre>
<p><img src="img/facet_wrap-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="exercise-31" class="section level3" number="10.1.3">
<h3 number="10.1.3"><span class="header-section-number">10.1.3</span> exercise</h3>
<p>Now map <em>both</em> <code>region</code> and <code>trans_type</code> to <code>facet_wrap()</code> and set the <code>ncol</code> to <code>6</code>.</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = region, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(_______ ~ _______, ncol = _) + 
  lab_top_cities</code></pre>
</div>
<div id="solution-32" class="section level3" number="10.1.4">
<h3 number="10.1.4"><span class="header-section-number">10.1.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = region, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(region ~ trans_type, ncol = 6) + 
  lab_top_cities</code></pre>
<p><img src="img/facet_wrap-2-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="complete-themes" class="section level2 tabset" number="10.2">
<h2 class="tabset" number="10.2"><span class="header-section-number">10.2</span> Complete Themes</h2>
<p><code>ggplot2</code> comes with a few default theme settings. Read more about them <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">here</a>. These themes come with arguments to adjust the <code>font_size</code> and <code>font_family</code> on our plot.</p>
<pre class="r"><code>theme_minimal(
  base_size = 11,
  base_family = &quot;&quot;,
  base_line_size = base_size/22,
  base_rect_size = base_size/22
)</code></pre>
<div id="exercise-32" class="section level3" number="10.2.1">
<h3 number="10.2.1"><span class="header-section-number">10.2.1</span> exercise</h3>
<p>We’ll use the <code>theme_minimal()</code> function to reduce the number of <code>elements</code> on our graph (don’t add any arguments).</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = region, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(region ~ trans_type, ncol = 6) + 
  ______________() +
  lab_top_cities </code></pre>
</div>
<div id="solution-33" class="section level3" number="10.2.2">
<h3 number="10.2.2"><span class="header-section-number">10.2.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = region, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(region ~ trans_type, ncol = 6) + 
  theme_minimal() +
  lab_top_cities </code></pre>
<p><img src="img/theme_minimal-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="theme-elements" class="section level2 tabset" number="10.3">
<h2 class="tabset" number="10.3"><span class="header-section-number">10.3</span> Theme elements</h2>
<p>Themes (accessible with the <code>theme</code> function) give up the ability to customize various <code>element_()</code> settings, which affect the ‘look’ of our graph.</p>
<div id="exercise-33" class="section level3" number="10.3.1">
<h3 number="10.3.1"><span class="header-section-number">10.3.1</span> exercise</h3>
<p>We will start by moving the <code>legend.position</code> to <code>"top"</code> so it’s not crowding the <code>x</code> axis on our graph.</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = region, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(region ~ trans_type, ncol = 6) + 
  theme_minimal() + 
  theme(___________ = _____) +
  lab_top_cities </code></pre>
</div>
<div id="solution-34" class="section level3" number="10.3.2">
<h3 number="10.3.2"><span class="header-section-number">10.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;% 
  ggplot(aes(x = date, y = dir_request, 
             group = region, 
             color = trans_type)) + 
  geom_line(size = 0.1) + 
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  facet_wrap(region ~ trans_type, ncol = 6) + 
  theme_minimal() + 
  theme(legend.position = &quot;top&quot;) +
  lab_top_cities </code></pre>
<p><img src="img/theme-sol-1.png" width="100%" height="100%" /></p>
<p>Notice we pass the <code>theme()</code> layer after the <code>theme_minimal()</code> layer (if we ordered these the other way around, <code>theme_minimal()</code> would overwrite any custom settings we made in <code>theme()</code>).</p>
</div>
</div>
<div id="small-multiples" class="section level2 tabset" number="10.4">
<h2 class="tabset" number="10.4"><span class="header-section-number">10.4</span> Small Multiples</h2>
<p>What if we wanted to facet more than 8 cities? Fortunately, we have a the <a href="https://ggforce.data-imaginist.com"><code>ggforce</code></a> and <a href="https://hafen.github.io/geofacet/index.html"><code>geofacet</code></a> packages for doing just that!</p>
<pre class="r"><code>library(sf)
library(geofacet)
library(ggforce)
library(jcolors)</code></pre>
<p><strong>Building the Graph Data</strong></p>
<ol style="list-style-type: decimal">
<li><p>We will start by filtering the <code>TidyApple</code> to only the 50 US states (we’ve removed three US territories) and storing these data in <code>TidyAppleUS</code>.</p></li>
<li><p>Next we limit the date range to the beginning of the shelter in place (from February 1, 2020 to May 1, 2020). These data get stored in <code>TidyAppleUST1</code>.</p></li>
<li><p>We then create a dataset with only <code>"transit"</code> direction requests, and we count these by state (<code>sub_region</code>), arrange the data descending with <code>sort = TRUE</code>, and take the top 25 rows (<code>Top25TransitStates</code>).</p></li>
</ol>
<p>Finally, we filter <code>TidyAppleUST1</code> using the 25 states in <code>Top25TransitStates</code> to create our graphing dataset, <code>Top25TransitUSAllT1</code>.</p>
<pre class="r"><code># create only US states (TidyAppleUS)
TidyApple %&gt;% 
  filter(country == &quot;United States&quot; &amp; 
         !sub_region %in% c(&quot;Guam&quot;, &quot;Puerto Rico&quot;, 
                            &quot;Virgin Islands&quot;)) -&gt; TidyAppleUS
# create shelter in place time 1 (TidyAppleUST1)
TidyAppleUS %&gt;% 
  filter(date &gt;= as_date(&quot;2020-02-01&quot;) &amp;
           date &lt;= as_date(&quot;2020-05-01&quot;)) -&gt; TidyAppleUST1

# create top 25 states (Top25TransitStates)
Top25TransitStates &lt;- TidyAppleUST1 %&gt;% 
  filter(trans_type == &quot;transit&quot;) %&gt;% 
  count(sub_region, trans_type, sort = TRUE) %&gt;% 
  head(25)

# filter T1 to states with the most transit requests (Top25TransitUSAllT1)
TidyAppleUST1 %&gt;% 
  filter(sub_region %in% 
           unique(Top25TransitStates$sub_region)) -&gt; Top25TransitUSAllT1

Top25TransitUSAllT1 %&gt;% skimr::skim()</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">188643</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geo_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">39</td>
<td align="right">0</td>
<td align="right">1058</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">trans_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sub_region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">25</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-02-01</td>
<td align="left">2020-05-01</td>
<td align="left">2020-03-17</td>
<td align="right">91</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dir_request</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">92.68</td>
<td align="right">36.02</td>
<td align="right">0.44</td>
<td align="right">68.64</td>
<td align="right">93.6</td>
<td align="right">113.14</td>
<td align="right">1379.02</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<div id="exercise-34" class="section level3" number="10.4.1">
<h3 number="10.4.1"><span class="header-section-number">10.4.1</span> exercise</h3>
<ul>
<li><p>set <code>title</code> to <code>"States With Highest Transit Direction Requests"</code></p></li>
<li><p>set <code>subtitle</code> to <code>"Top 25 states based on number of total transit requests"</code></p></li>
</ul>
<pre class="r"><code>lab_facet_wrap_paginate &lt;- labs(
       x = &quot;Date&quot;, y = &quot;Direction Requests&quot;, 
       title = _____________________________________,
       subtitle = _____________________________________)</code></pre>
</div>
<div id="solution-35" class="section level3" number="10.4.2">
<h3 number="10.4.2"><span class="header-section-number">10.4.2</span> solution</h3>
<pre class="r"><code>lab_facet_wrap_paginate &lt;- labs(
       x = &quot;Date&quot;, y = &quot;Direction Requests&quot;, 
       title = &quot;States With Highest Transit Direction Requests&quot;,
       subtitle = &quot;Top 25 states based on number of total transit requests&quot;)</code></pre>
</div>
<div id="exercise-35" class="section level3" number="10.4.3">
<h3 number="10.4.3"><span class="header-section-number">10.4.3</span> exercise</h3>
<p>Inside <code>ggforce::facet_wrap_paginate()</code>:</p>
<ul>
<li><p>map <code>sub_region</code> as the variable to facet using the <code>~</code></p></li>
<li><p>map <code>5</code> to <code>ncol</code></p></li>
<li><p>map <code>"free_y"</code> to <code>scales</code></p></li>
</ul>
<p>Inside <code>theme()</code></p>
<ul>
<li><p>map <code>element_blank()</code> to <code>panel.border</code> and <code>panel.background</code></p></li>
<li><p>map <code>element_text(size = 6)</code> to <code>axis.text.x</code> and <code>axis.text.y</code></p></li>
<li><p>map <code>element_text(colour = 'black')</code> to <code>strip.text</code></p></li>
<li><p>map <code>element_rect(fill = "gray93")</code> to <code>strip.background</code></p></li>
<li><p>map <code>"top"</code> to <code>legend.position</code></p></li>
</ul>
<pre class="r"><code>Top25TransitUSAllT1 %&gt;% 
  # global settings
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  # lines
  geom_hline(yintercept = 100, size = 0.3, color = &quot;black&quot;) + 
  geom_line(size = 0.2) +
  # faceting
  ggforce::facet_wrap_paginate(~ __________, 
                               ncol = _, 
                               scales = _______) + 
  # theme settings
  theme(__________ = __________(), 
        __________ = __________(),
        
        __________ = __________(size = _), 
        __________ = __________(size = _),
        
        __________ = __________(colour = __________),
        
        __________ = __________(fill = __________), 
        
        __________ = __________) + 
  # labels
  lab_facet_wrap_paginate</code></pre>
</div>
<div id="solution-36" class="section level3" number="10.4.4">
<h3 number="10.4.4"><span class="header-section-number">10.4.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>Top25TransitUSAllT1 %&gt;% 
  # global settings
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  # lines
  geom_hline(yintercept = 100, size = 0.3, color = &quot;black&quot;) + 
  geom_line(size = 0.2) +
  # faceting
  ggforce::facet_wrap_paginate(~ sub_region, 
                               ncol = 5, 
                               scales = &quot;free_y&quot;) + 
  # theme settings
  theme(panel.border = element_blank(), 
        panel.background = element_blank(),
        axis.text.x = element_text(size = 6), 
        axis.text.y = element_text(size = 6),
        strip.text = element_text(colour = &#39;black&#39;),
        strip.background = element_rect(fill = &quot;gray93&quot;), 
        legend.position = &quot;top&quot;) + 
  # labels
  lab_facet_wrap_paginate</code></pre>
<p><img src="img/facet_wrap_paginate-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="adjusting-colors" class="section level2 tabset" number="10.5">
<h2 class="tabset" number="10.5"><span class="header-section-number">10.5</span> Adjusting Colors</h2>
<p>Changing the colors on graphs gives us the ability to further customize their look. We can set these manually, or use one of the many complete color palettes from a user-written package. Below we’ll use the <a href="https://jaredhuling.org/jcolors/index.html"><code>jcolors</code> package</a> to highlight the <code>transit</code> direction requests from the previous graph.</p>
<div id="exercise-36" class="section level3" number="10.5.1">
<h3 number="10.5.1"><span class="header-section-number">10.5.1</span> exercise</h3>
<ul>
<li>add <code>scale_color_jcolors()</code> and play with the <code>palette</code> argument to make the graph look like the <code>solution</code>.</li>
</ul>
<pre class="r"><code>Top25TransitUSAllT1 %&gt;% 
  # global settings
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  # lines
  geom_hline(yintercept = 100, size = 0.3, color = &quot;black&quot;) + 
  geom_line(size = 0.2) +
  # faceting
  ggforce::facet_wrap_paginate(~ sub_region, 
                               ncol = 5, 
                               scales = &quot;free_y&quot;) + 
  # theme settings
  theme(panel.border = element_blank(), 
        panel.background = element_blank(),
        axis.text.x = element_text(size = 6), 
        axis.text.y = element_text(size = 6),
        strip.text = element_text(colour = &#39;black&#39;),
        strip.background = element_rect(fill = &quot;gray93&quot;), 
        legend.position = &quot;top&quot;) + 
  # adjust colors
  __________________________(palette = ____) + 
  
  lab_facet_wrap_paginate</code></pre>
</div>
<div id="solution-37" class="section level3" number="10.5.2">
<h3 number="10.5.2"><span class="header-section-number">10.5.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>Top25TransitUSAllT1 %&gt;% 
  # global settings
  ggplot(aes(x = date, y = dir_request, 
             group = trans_type, 
             color = trans_type)) + 
  # lines
  geom_hline(yintercept = 100, size = 0.3, color = &quot;black&quot;) + 
  geom_line(size = 0.2) +
  # faceting
  ggforce::facet_wrap_paginate(~ sub_region, 
                               ncol = 5, 
                               scales = &quot;free_y&quot;) + 
  # theme settings
  theme(panel.border = element_blank(), 
        panel.background = element_blank(),
        axis.text.x = element_text(size = 6), 
        axis.text.y = element_text(size = 6),
        strip.text = element_text(colour = &#39;black&#39;),
        strip.background = element_rect(fill = &quot;gray93&quot;), 
        legend.position = &quot;top&quot;) + 
  
  scale_color_jcolors(palette = &quot;pal3&quot;) + 
  
  lab_facet_wrap_paginate</code></pre>
<p><img src="img/scale_color_jcolors-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="extra-geofacet" class="section level2 tabset" number="10.6">
<h2 class="tabset" number="10.6"><span class="header-section-number">10.6</span> Extra: <code>geofacet</code></h2>
<p>We’re now going to look at all 50 states using the <code>facet_geo()</code> function from the <code>geofacet</code> package. To make this graph easier to interpret, we’re going to focus only on walking mobility data, and adjust the <code>dir_request</code> value to absolute change from baseline (set to <code>100</code> on <code>2020-01-13</code>).</p>
<div id="adjusted-walking-data" class="section level3" number="10.6.1">
<h3 number="10.6.1"><span class="header-section-number">10.6.1</span> Adjusted Walking Data</h3>
<p>Create the <code>USWalkingAdj</code> data by filtering the <code>trans_type</code> to <code>"walking"</code> and creating two new variables: <code>above_below</code> (a logical indicator for values being above or below the baseline value of <code>100</code>), and <code>dir_request_adj</code> (the adjusted direction request value).</p>
</div>
<div id="exercise-37" class="section level3" number="10.6.2">
<h3 number="10.6.2"><span class="header-section-number">10.6.2</span> exercise</h3>
<p>Fill in the correct variables in the wrangling steps below:</p>
<pre class="r"><code>USWalkingAdj &lt;- TidyAppleUS %&gt;% 
  filter(trans_type == _________) %&gt;%
  mutate(above_below = _________ &lt; 100, 
         dir_request_adj = _________ - 100)

USWalkingAdj %&gt;% 
  skimr::skim()</code></pre>
</div>
<div id="solution-38" class="section level3" number="10.6.3">
<h3 number="10.6.3"><span class="header-section-number">10.6.3</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>USWalkingAdj &lt;- TidyAppleUS %&gt;% 
  filter(trans_type == &quot;walking&quot;) %&gt;%
  mutate(above_below = dir_request &lt; 100, 
         dir_request_adj = dir_request - 100)

USWalkingAdj %&gt;% 
  skimr::skim()</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">160085</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">logical</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geo_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">39</td>
<td align="right">0</td>
<td align="right">452</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">trans_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sub_region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">48</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-01-13</td>
<td align="left">2020-11-24</td>
<td align="left">2020-06-19</td>
<td align="right">317</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="left">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">above_below</td>
<td align="right">220</td>
<td align="right">1</td>
<td align="right">0.32</td>
<td align="left">FAL: 108071, TRU: 51794</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dir_request</td>
<td align="right">220</td>
<td align="right">1</td>
<td align="right">129.36</td>
<td align="right">63.68</td>
<td align="right">0.44</td>
<td align="right">89.44</td>
<td align="right">122.7</td>
<td align="right">163.82</td>
<td align="right">1379.02</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">dir_request_adj</td>
<td align="right">220</td>
<td align="right">1</td>
<td align="right">29.36</td>
<td align="right">63.68</td>
<td align="right">-99.56</td>
<td align="right">-10.56</td>
<td align="right">22.7</td>
<td align="right">63.82</td>
<td align="right">1279.02</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-38" class="section level3" number="10.6.4">
<h3 number="10.6.4"><span class="header-section-number">10.6.4</span> exercise</h3>
<p>Assign the following to the labels:</p>
<ul>
<li><p>set <code>"US Trends in Mobility Data for Walking (Adjusted)"</code> to <code>title</code></p></li>
<li><p>set <code>"https://covid19.apple.com/mobility"</code> to <code>caption</code></p></li>
</ul>
<pre class="r"><code>lab_facet_geo &lt;- labs(x = &quot;Date&quot;, 
                      y = &quot;Direction Requests (Walking)&quot;, 
       title = ____________________________________________, 
       subtitle = paste0(&quot;Original data uses 100 as baseline for usage at &quot;, 
                         min(USWalkingAdj$date)), 
       caption = ____________________________________________, 
       fill = &quot;Below Baseline&quot;)</code></pre>
</div>
<div id="solution-39" class="section level3" number="10.6.5">
<h3 number="10.6.5"><span class="header-section-number">10.6.5</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_facet_geo &lt;- labs(x = &quot;Date&quot;, 
                      y = &quot;Direction Requests (Walking)&quot;, 
       title = &quot;US Trends in Mobility Data for Walking (Adjusted)&quot;, 
       subtitle = paste0(&quot;Original data uses 100 as baseline for usage at &quot;, 
                         min(USWalkingAdj$date)), 
       caption = &quot;https://covid19.apple.com/mobility&quot;,
       fill = &quot;Below Baseline&quot;)</code></pre>
</div>
<div id="exercise-39" class="section level3" number="10.6.6">
<h3 number="10.6.6"><span class="header-section-number">10.6.6</span> exercise</h3>
<ul>
<li><p>set the colors in <code>color_bl_or</code> as <code>c("#8470FF", "#7FFFD4")</code></p></li>
<li><p>set <code>yintercept</code> to <code>0</code> in <code>geom_hline()</code></p></li>
<li><p>set the <code>values</code> in <code>scale_fill_manual()</code> to <code>color_bl_or</code></p></li>
<li><p>map <code>sub_region</code> to <code>facet_geo</code> using <code>~</code></p></li>
</ul>
<p>Inside <code>theme()</code></p>
<ul>
<li>set the <code>panel.border</code> and <code>panel.background</code> to <code>element_blank()</code><br />
</li>
<li>set the <code>axis.text.x</code> and <code>axis.text.y</code> to <code>element_text(size = 6)</code></li>
<li>set the <code>strip.text.x</code> to <code>element_text(size = 7)</code><br />
</li>
<li>set <code>strip.text</code> to <code>element_text(colour = 'white')</code><br />
</li>
<li>set <code>strip.background</code> to <code>element_rect(fill = "black")</code><br />
</li>
<li>set <code>legend.position</code> to <code>"bottom"</code></li>
</ul>
<pre class="r"><code># set colors
color_bl_or &lt;- c(____________, ____________)

USWalkingAdj %&gt;% 
  ggplot(aes(x = date, y = dir_request_adj, 
             group = sub_region, fill = above_below)) + 
  
  geom_col() + 
  
  geom_hline(yintercept = _, color = &quot;gray7&quot;) + 
  
  scale_fill_manual(values = ____________) +
  
  facet_geo(~ sub_region) +
  
  theme_bw() + 
  
  theme(______________ = ______________(), 
        ______________ = ______________(),
        
        ______________ = ______________(size = _), 
        ______________ = ______________(size = _),
        ______________ = ______________(size = _),
        
        ______________ = ______________(colour = ______________),
        ______________ = ______________(fill = ______________), 
        
        ______________ = ______________) + 
  
  lab_facet_geo</code></pre>
</div>
<div id="solution-40" class="section level3" number="10.6.7">
<h3 number="10.6.7"><span class="header-section-number">10.6.7</span> solution</h3>
<p>See below:</p>
<pre class="r"><code># set colors
color_bl_or &lt;- c(&quot;#8470FF&quot;, &quot;#7FFFD4&quot;)

USWalkingAdj %&gt;% 
  ggplot(aes(x = date, y = dir_request_adj, 
             group = sub_region, fill = above_below)) + 
  
  geom_col() + 
  
  geom_hline(yintercept = 0, 
             color = &quot;gray7&quot;) + 
  
  scale_fill_manual(values = color_bl_or) +
  
  facet_geo(~ sub_region) +
  
  theme_bw() + 
  
  theme(panel.border = element_blank(), 
        panel.background = element_blank(),
        axis.text.x = element_text(size = 6), 
        axis.text.y = element_text(size = 6),
        strip.text.x = element_text(size = 7),
        strip.text = element_text(colour = &#39;white&#39;),
        strip.background = element_rect(fill = &quot;black&quot;), 
        legend.position = &quot;bottom&quot;) + 
  
  lab_facet_geo</code></pre>
<p><img src="img/facet_geo-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
</div>
<div id="wrap-up" class="section level1" number="11">
<h1 number="11"><span class="header-section-number">11</span> Wrap Up</h1>
<p><strong>Original Question:</strong> <em>How has COVID changed our modes of transportation?</em></p>
<ol style="list-style-type: decimal">
<li><p>Which graphs do you feel are best at answering this question? Why?</p></li>
<li><p>What other information (tables, annotations, etc.) would you include with the graphs?</p></li>
</ol>
</div>

<i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
