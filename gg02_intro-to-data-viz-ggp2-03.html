<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Visualization with ggplot2 (multiple variable visualizations)</title>

<script src="site_libs/header-attrs-2.7.2/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CSUC Data Journalism</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Course outline</a>
</li>
<li>
  <a href="lessons-exercises.html">Lessons and exercises</a>
</li>
<li>
  <a href="slides.html">Slides</a>
</li>
<li>
  <a href="more-resources.html">More resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data Visualization with ggplot2 (multiple variable visualizations)</h1>

</div>


<div id="outline" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Outline</h1>
<ol style="list-style-type: decimal">
<li>Import Apple Mobility Data</li>
<li>Wrangle Apple Mobility Data</li>
<li>Counting things</li>
<li>Histograms</li>
<li>Density plots</li>
<li>Ridgeline plots</li>
<li>Violin plots</li>
</ol>
</div>
<div id="import-tidyapple-data" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Import <code>TidyApple</code> data</h1>
<p>We’re going to import the data from the previous exercises.</p>
<pre class="r"><code>TidyApple &lt;- readr::read_csv(&quot;https://bit.ly/3deFcBy&quot;)</code></pre>
</div>
<div id="visualizing-trends" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Visualizing Trends</h1>
<p>We’ve seen the distribution of <code>dir_request</code>, and how it varies across <code>trans_type</code>.</p>
<p>Now we’ll look at how the relationship between these two variables varies over in a subset of US cities and across a specific <code>date</code> range.</p>
<div id="focus-on-us-cities" class="section level2 tabset" number="3.1">
<h2 class="tabset" number="3.1"><span class="header-section-number">3.1</span> Focus on US Cities</h2>
<p>We’ll start by narrowing down the data by filtering to only US cities.</p>
<div id="exercise" class="section level3" number="3.1.1">
<h3 number="3.1.1"><span class="header-section-number">3.1.1</span> exercise</h3>
<p>Filter the <code>geo_type</code> to <code>"city"</code> and the <code>country</code> to <code>"United States"</code>, and pass the <code>date</code> variable to <code>skimr::skim()</code></p>
<pre class="r"><code>TidyApple %&gt;%
  filter(geo_type == ___________ &amp;
              country == ___________) %&gt;%
                # use skimr to check date
                skimr::skim(___________)</code></pre>
</div>
<div id="solution" class="section level3" number="3.1.2">
<h3 number="3.1.2"><span class="header-section-number">3.1.2</span> solution</h3>
<p>Here we reduce the dataset to only cities in the US, and we check the <code>date</code> range with <code>skimr::skim()</code>. If this looks OK, we assign to <code>USCities</code></p>
<pre class="r"><code>TidyApple %&gt;%
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;) %&gt;%
                # use skimr to check date
                skimr::skim(date)</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">99538</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-01-13</td>
<td align="left">2020-11-24</td>
<td align="left">2020-06-19</td>
<td align="right">317</td>
</tr>
</tbody>
</table>
<pre class="r"><code>TidyApple %&gt;%
  filter(geo_type == &quot;city&quot; &amp;
         country == &quot;United States&quot;) -&gt; USCities</code></pre>
</div>
</div>
<div id="updating-labels" class="section level2 tabset" number="3.2">
<h2 class="tabset" number="3.2"><span class="header-section-number">3.2</span> Updating Labels</h2>
<p>We can see this date range is from 2020-01-13 to 2020-11-24.</p>
<div id="exercise-1" class="section level3" number="3.2.1">
<h3 number="3.2.1"><span class="header-section-number">3.2.1</span> exercise</h3>
<p>Use <code>paste0()</code> to combine the first and last <code>date</code> in the filtered <code>USCities</code> dataset.</p>
<pre class="r"><code>paste0(min(______________$____),
       &quot; through &quot;,
       max(______________$____))</code></pre>
</div>
<div id="solution-1" class="section level3" number="3.2.2">
<h3 number="3.2.2"><span class="header-section-number">3.2.2</span> solution</h3>
<pre class="r"><code>paste0(min(USCities$date),
       &quot; through &quot;,
       max(USCities$date))</code></pre>
<pre><code>## [1] &quot;2020-01-13 through 2020-11-24&quot;</code></pre>
<p>We want to specify this in our labels object (<code>lab_line_update</code>), so we will use the <code>paste0()</code> function to have the labels update every time the data changes.</p>
<pre class="r"><code>labs(x = &quot;Date&quot;,
     y = &quot;Direction Requests&quot;,
     title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
     subtitle = paste0(min(USCities$date),
                       &quot; through &quot;,
                       max(USCities$date)),
     caption = &quot;source: https://covid19.apple.com/mobility&quot;,
     color = &quot;Transit Type&quot;) -&gt; lab_line_update</code></pre>
<p>We’re going to create a line graph of direction requests over time, colored by color.</p>
</div>
<div id="exercise-2" class="section level3" number="3.2.3">
<h3 number="3.2.3"><span class="header-section-number">3.2.3</span> exercise</h3>
<p>Pass the filtered data to the <code>geom_line()</code>, mapping the following variables to their relative aesthetics:</p>
<ul>
<li><code>date</code> to <code>x</code></li>
<li><code>dir_request</code> to <code>y</code></li>
<li><code>trans_type</code> to both <code>group</code> and <code>color</code></li>
</ul>
<p>Include <code>lab_line_update</code> to see how the new labels look!</p>
<pre class="r"><code>USCities %&gt;%
  ggplot() +
  geom_line(aes(x = __________, y = __________,
             group = __________, color = __________)) +
  __________</code></pre>
</div>
<div id="solution-2" class="section level3" number="3.2.4">
<h3 number="3.2.4"><span class="header-section-number">3.2.4</span> solution</h3>
<p>Let’s see what happens when we use <code>lab_line_update</code>.</p>
<pre class="r"><code>USCities %&gt;%
  ggplot() +
  geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type)) +
  lab_line_update</code></pre>
<p><img src="img/geom-line-us-cities-sol-1.png" width="100%" height="100%" /></p>
<p>The dates updated to the min and max <code>date</code> in <code>USCities</code>.</p>
</div>
</div>
<div id="adjusting-line-size" class="section level2 tabset" number="3.3">
<h2 class="tabset" number="3.3"><span class="header-section-number">3.3</span> Adjusting Line Size</h2>
<p>These lines in this graph are overlapping each other, so we will adjust the <code>size</code> to <code>0.20</code>.</p>
<div id="exercise-3" class="section level3" number="3.3.1">
<h3 number="3.3.1"><span class="header-section-number">3.3.1</span> exercise</h3>
<p>Change the size of the <code>geom_line()</code> (outside of <code>aes()</code>).</p>
<pre class="r"><code>USCities %&gt;%
  ggplot() +
  geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
            size = ____________) +
  lab_line01</code></pre>
</div>
<div id="solution-3" class="section level3" number="3.3.2">
<h3 number="3.3.2"><span class="header-section-number">3.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>USCities %&gt;%
  ggplot() +
  geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
            size = 0.20) +
  lab_line_update</code></pre>
<p><img src="img/us-cities-line-alpha-sol-1.png" width="100%" height="100%" /></p>
<p>Now the trends are easier to see.</p>
</div>
</div>
<div id="setting-date-range" class="section level2 tabset" number="3.4">
<h2 class="tabset" number="3.4"><span class="header-section-number">3.4</span> Setting Date Range</h2>
<p>We are going to only look at the trends between February and August of 2020, but we’re going to use an alternative method to <code>filter</code> the data and create the labels.</p>
<p>We will create two new objects (<code>start_date</code> and <code>end_date</code>), which we can use to narrow the dates using the <code>filter()</code> function (and anywhere else we need to use this date range).</p>
<p>This method is better than passing the dates as a character (i.e. in quotes), because we would only have to change it in one place. However, the option above makes better use of R functional programming syntax.</p>
<div id="exercise-4" class="section level3" number="3.4.1">
<h3 number="3.4.1"><span class="header-section-number">3.4.1</span> exercise</h3>
<p>Pass the <code>start_date</code> and <code>end_date</code> to the <code>as_date()</code> functions, and take a look at the <code>date</code> variable with <code>skimr::skim()</code> and if it looks correct, assign it to <code>USCitiesFebJul</code></p>
<pre class="r"><code># create date objects
start_date &lt;- &quot;2020-02-01&quot;
end_date &lt;- &quot;2020-08-01&quot;
# check with skimr
TidyApple %&gt;%
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;,
                date &gt;= as_date(_____________) &amp;
                  date &lt;= as_date(_____________)) %&gt;%
                  skimr::skim(_____________)</code></pre>
</div>
<div id="solution-4" class="section level3" number="3.4.2">
<h3 number="3.4.2"><span class="header-section-number">3.4.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code># create date objects
start_date &lt;- &quot;2020-02-01&quot;
end_date &lt;- &quot;2020-08-01&quot;
# check with skimr
TidyApple %&gt;%
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;,
                date &gt;= as_date(start_date) &amp;
                  date &lt;= as_date(end_date)) -&gt; USCitiesFebJul

USCitiesFebJul %&gt;%
  skimr::skim(date)</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">57462</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-02-01</td>
<td align="left">2020-08-01</td>
<td align="left">2020-05-02</td>
<td align="right">183</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-5" class="section level3" number="3.4.3">
<h3 number="3.4.3"><span class="header-section-number">3.4.3</span> exercise</h3>
<p>Create the new labels (<code>lab_line_paste</code>) with the <code>paste0()</code> function by passing both <code>start_date</code> and <code>end_date</code>.</p>
<pre class="r"><code>lab_line_paste &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(___________, &quot; through &quot;, ___________),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;,
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-5" class="section level3" number="3.4.4">
<h3 number="3.4.4"><span class="header-section-number">3.4.4</span> solution</h3>
<pre class="r"><code>lab_line_paste &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(start_date, &quot; through &quot;, end_date),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;,
                 color = &quot;Transit Type&quot;)

USCitiesFebJul %&gt;%
  ggplot() +
  geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
            # make these slightly larger...
            size = 0.30) +
  lab_line_paste</code></pre>
<p><img src="img/create-lab_line_paste-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
</div>
<div id="adding-text-to-graphs" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Adding Text to Graphs</h1>
<p>We can see there is a gap in the direct request data (this is <a href="https://covid19.apple.com/mobility">documented in the data source</a>).</p>
<blockquote>
<p><em>“Data for May 11-12 is not available and will appear as blank columns in the data set.”</em></p>
</blockquote>
<p>We should communicate this gap with our audience, and we might include a text annotation on the graph so our audience isn’t distracted by the gap.</p>
<p>In the previous lesson, we introduced the <code>ggrepel</code> package to show the points on this graph of top performing pharmaceutical companies.</p>
<p><img src="img/aes-sol-11-1.png" width="70%" height="70%" style="display: block; margin: auto;" /></p>
<p>We’re going to use labels to annotate and highlight US cities between March and June of 2020.</p>
<div id="annotations" class="section level2 tabset" number="4.1">
<h2 class="tabset" number="4.1"><span class="header-section-number">4.1</span> Annotations</h2>
<p>Being able to manually add text and annotations as layers to your graph makes it easier to communicate the nuances of your data to your audience. We are going to start by accounting for the missing data in <code>TidyApple</code>.</p>
<div id="exercise-6" class="section level3" number="4.1.1">
<h3 number="4.1.1"><span class="header-section-number">4.1.1</span> exercise</h3>
<p>Build a dataset from <code>TidyApple</code> that only has US cities, and ranges from March 1, 2020 to June 30, 2020.</p>
<pre class="r"><code>USCitiesMarJun &lt;-  TidyApple %&gt;%
  filter(geo_type == ___________ &amp;
              country == ___________,
                date &gt;= as_date(___________) &amp;
                  date &lt;= as_date(___________))

USCitiesMarJun %&gt;%
                  skimr::skim()</code></pre>
</div>
<div id="solution-6" class="section level3" number="4.1.2">
<h3 number="4.1.2"><span class="header-section-number">4.1.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>USCitiesMarJun &lt;-  TidyApple %&gt;%
  filter(geo_type == &quot;city&quot; &amp;
              country == &quot;United States&quot;,
                date &gt;= as_date(&quot;2020-03-01&quot;) &amp;
                  date &lt;= as_date(&quot;2020-07-01&quot;))

USCitiesMarJun %&gt;% skimr::skim()</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Piped data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">38622</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">Date</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">numeric</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geo_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">39</td>
<td align="right">0</td>
<td align="right">111</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">trans_type</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sub_region</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">39</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">date</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2020-03-01</td>
<td align="left">2020-07-01</td>
<td align="left">2020-05-01</td>
<td align="right">123</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dir_request</td>
<td align="right">628</td>
<td align="right">0.98</td>
<td align="right">82.06</td>
<td align="right">41.11</td>
<td align="right">4.37</td>
<td align="right">50.87</td>
<td align="right">74.38</td>
<td align="right">109.11</td>
<td align="right">525.44</td>
<td align="left">▇▃▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-7" class="section level3" number="4.1.3">
<h3 number="4.1.3"><span class="header-section-number">4.1.3</span> exercise</h3>
<p>We’re going to build labels using the <code>paste0()</code> function. Fill in the appropriate dataset for the <code>min()</code> and <code>max()</code> date.</p>
<pre class="r"><code>lab_annotate &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(min(______________$date),
                                   &quot; through &quot;,
                                   max(______________$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;,
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-7" class="section level3" number="4.1.4">
<h3 number="4.1.4"><span class="header-section-number">4.1.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_annotate &lt;- labs(x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Direction Requests Over Time (US Cities Only)&quot;,
                 subtitle = paste0(min(USCitiesMarJun$date),
                                   &quot; through &quot;,
                                   max(USCitiesMarJun$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;,
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="exercise-8" class="section level3" number="4.1.5">
<h3 number="4.1.5"><span class="header-section-number">4.1.5</span> exercise</h3>
<p>The previous code for the graph has been added. We’re going to add the following layers:</p>
<p>Inside <code>coord_cartesian()</code>:</p>
<ul>
<li>map <code>min(USCitiesMarJun$date)</code> and <code>max(USCitiesMarJun$date)</code> inside <code>c()</code> to <code>xlim</code></li>
<li>map <code>min(USCitiesMarJun$dir_request, na.rm = TRUE)</code> and <code>max(USCitiesMarJun$dir_request, na.rm = TRUE)</code> inside <code>c()</code> to <code>ylim</code></li>
</ul>
<p>Inside the <code># horizontal</code> <code>annotate()</code>:</p>
<ul>
<li>set <code>geom</code> to <code>"segment"</code></li>
<li>map <code>0.5</code> to <code>size</code></li>
<li>map <code>"firebrick3"</code> to <code>color</code></li>
<li>map <code>lubridate::as_date("2020-05-10")</code> to <code>x</code></li>
<li>map <code>lubridate::as_date("2020-05-13")</code> to <code>xend</code></li>
<li>map <code>100</code> to <code>y</code> and <code>yend</code></li>
</ul>
<p>Inside the <code># big vertical</code> <code>annotate()</code>:</p>
<ul>
<li>set <code>geom</code> to <code>"segment"</code></li>
<li>map <code>1</code> to <code>size</code></li>
<li>map <code>"firebrick3"</code> to <code>color</code></li>
<li>map <code>lubridate::as_date("2020-05-11")</code> to <code>x</code></li>
<li>map <code>lubridate::as_date("2020-05-11")</code> to <code>xend</code></li>
<li>map <code>270</code> to <code>y</code> and <code>100</code> to <code>yend</code></li>
</ul>
<p>Inside the <code># text</code> <code>annotate()</code>:</p>
<ul>
<li>set <code>geom</code> to <code>"text"</code></li>
<li>map <code>8</code> to <code>size</code></li>
<li>map <code>"red"</code> to <code>color</code></li>
<li>map <code>0.5</code> to <code>hjust</code></li>
<li>map <code>lubridate::as_date("2020-05-07")</code> to <code>x</code></li>
<li>map <code>280</code> to <code>y</code></li>
<li>map <code>"Data not available"</code> to <code>label</code></li>
</ul>
<pre class="r"><code>USCitiesMarJun %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
             # make these slightly larger...
             size = 0.30) +
   # coordinate system
   coord_cartesian(xlim = c(_______________, _______________),

                   ylim = c(_______________, na.rm = __________),
                            _______________, na.rm = __________))) +
   # horizontal
   annotate(geom = ___________, size = ___________, color = ___________,
                  x = ___________,
                  xend = ___________,
                  y = ___________,
                  yend = ___________) +
    # big vertical
    annotate(geom = ___________,
            size = ___________,
            color = ___________,
            x = ___________,
            xend = ___________,
            y = ___________, yend = ___________) +
    # text
    annotate(geom = &quot;text&quot;,
               size = 8,
               color = &quot;red&quot;,
               hjust = 0.5,
               x = lubridate::as_date(&quot;2020-05-07&quot;),
               y = 280,
               label = &quot;Data not available&quot;) +

    lab_annotate</code></pre>
</div>
<div id="solution-8" class="section level3" number="4.1.6">
<h3 number="4.1.6"><span class="header-section-number">4.1.6</span> solution</h3>
<pre class="r"><code># plot
USCitiesMarJun %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
             # make these slightly larger...
             size = 0.30) +
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date),
                            max(USCitiesMarJun$date)),

                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE),
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
   # horizontal
   annotate(geom = &quot;segment&quot;,
            size = 0.5,
            color = &quot;firebrick3&quot;,
                  x = lubridate::as_date(&quot;2020-05-10&quot;),
                  xend = lubridate::as_date(&quot;2020-05-13&quot;),
                             y = 100,
                             yend = 100) +
    # big vertical
    annotate(geom = &quot;segment&quot;,
            size = 1,
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-11&quot;),
            xend = lubridate::as_date(&quot;2020-05-11&quot;),
            y = 270, yend = 100) +

    # text
    annotate(geom = &quot;text&quot;,
               color = &quot;red&quot;,
               hjust = 0.5,
               size = 8,
               x = lubridate::as_date(&quot;2020-05-07&quot;),
               y = 280,
               label = &quot;Data not available&quot;) +

    lab_annotate</code></pre>
<p><img src="img/coord_cartesian-annotate-text-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="exercise-9" class="section level3" number="4.1.7">
<h3 number="4.1.7"><span class="header-section-number">4.1.7</span> exercise</h3>
<p>Add a second and third vertical <code>segment</code> to create a fence or bracket for the dates with missing data.</p>
<pre class="r"><code># plot
USCitiesMarJun %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
             # make these slightly larger...
             size = 0.30) +
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date),
                            max(USCitiesMarJun$date)),

                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE),
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
   # horizontal
   annotate(geom = &quot;segment&quot;,
            size = 0.5,
            color = &quot;firebrick3&quot;,
                  x = lubridate::as_date(&quot;2020-05-10&quot;),
                  xend = lubridate::as_date(&quot;2020-05-13&quot;),
                             y = 100,
                             yend = 100) +
    # big vertical
    annotate(geom = &quot;segment&quot;,
            size = 1,
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-11&quot;),
            xend = lubridate::as_date(&quot;2020-05-11&quot;),
            y = 270, yend = 100) +
    # text
    annotate(geom = &quot;text&quot;,
               color = &quot;red&quot;,
               hjust = 0.5,
               size = 8,
               x = lubridate::as_date(&quot;2020-05-07&quot;),
               y = 280,
               label = &quot;Data not available&quot;) +
   # second vertical
   annotate(geom = &quot;segment&quot;,
            size = 0.5,
            color = &quot;firebrick3&quot;,
            x = _____________________________,
            xend = _____________________________,
            y = _____________________________,
            yend = _____________________________) +
    # third vertical
     annotate(geom = &quot;segment&quot;,
            size = 0.5,
            color = &quot;firebrick3&quot;,
            x = _____________________________,
            xend = _____________________________,
            y = _____________________________,
            yend = _____________________________) +

   lab_annotate</code></pre>
</div>
<div id="solution-9" class="section level3" number="4.1.8">
<h3 number="4.1.8"><span class="header-section-number">4.1.8</span> solution</h3>
<p>See below:</p>
<pre class="r"><code># plot
USCitiesMarJun %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
             # make these slightly larger...
             size = 0.30) +
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date),
                            max(USCitiesMarJun$date)),

                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE),
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
   # horizontal
   annotate(geom = &quot;segment&quot;,
            size = 0.5,
            color = &quot;firebrick3&quot;,
                  x = lubridate::as_date(&quot;2020-05-10&quot;),
                  xend = lubridate::as_date(&quot;2020-05-13&quot;),
                             y = 100,
                             yend = 100) +
    # big vertical
    annotate(geom = &quot;segment&quot;,
            size = 1,
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-11&quot;),
            xend = lubridate::as_date(&quot;2020-05-11&quot;),
            y = 270, yend = 100) +
    # text
    annotate(geom = &quot;text&quot;,
               color = &quot;red&quot;,
               hjust = 0.5,
               size = 8,
               x = lubridate::as_date(&quot;2020-05-07&quot;),
               y = 280,
               label = &quot;Data not available&quot;) +
   # second vertical
   annotate(geom = &quot;segment&quot;,
            size = 0.5,
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-10&quot;),
            xend = lubridate::as_date(&quot;2020-05-10&quot;),
            y = 100, yend = 90) +
    # third vertical
     annotate(geom = &quot;segment&quot;,
            size = 0.5,
            color = &quot;firebrick3&quot;,
            x = lubridate::as_date(&quot;2020-05-13&quot;),
            xend = lubridate::as_date(&quot;2020-05-13&quot;),
            y = 100, yend = 90) +

   lab_annotate</code></pre>
<p><img src="img/coord_cartesian-annotate-comp-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="plotting-area" class="section level2 tabset" number="4.2">
<h2 class="tabset" number="4.2"><span class="header-section-number">4.2</span> Plotting area</h2>
<p>Another option is to use <code>geom_rect()</code> to black out the missing data.</p>
<pre class="r"><code># plot
USCitiesMarJun %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
             group = trans_type, color = trans_type),
             # make these slightly larger...
             size = 0.30) +
   # coordinate system
   coord_cartesian(xlim = c(min(USCitiesMarJun$date),
                            max(USCitiesMarJun$date)),

                   ylim = c(min(USCitiesMarJun$dir_request, na.rm = TRUE),
                            max(USCitiesMarJun$dir_request, na.rm = TRUE))) +
  geom_rect(xmin = lubridate::as_date(&quot;2020-05-10&quot;),
            xmax = lubridate::as_date(&quot;2020-05-12&quot;),
            ymin = -Inf,
            ymax = Inf,
            color = NA) +
  geom_text(x = as.Date(&quot;2020-05-11&quot;),
            y = 100, label = &quot;Data Not Available&quot;,
            angle = 90, color = &quot;white&quot;) +
  lab_annotate</code></pre>
<p><img src="img/geom_rect-sol-1.png" width="100%" height="100%" /></p>
</div>
<div id="labeling-values" class="section level2 tabset" number="4.3">
<h2 class="tabset" number="4.3"><span class="header-section-number">4.3</span> Labeling Values</h2>
<p><strong>Max Driving Requests</strong></p>
<p>The code below creates a subset of the data (<code>TopUSCities</code>). We will use this to add the labels.</p>
<pre class="r"><code>TopUSCities &lt;- TidyApple %&gt;%
  filter(country == &quot;United States&quot; &amp;
           region %in% c(&quot;New York City&quot;, &quot;Los Angeles&quot;,
                         &quot;Chicago&quot;, &quot;Houston&quot;, &quot;Phoenix&quot;))
TopUSCities</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-13","7":"100.00"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-14","7":"103.68"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-15","7":"104.45"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-16","7":"108.72"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-17","7":"132.80"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-18","7":"113.44"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-19","7":"87.48"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-20","7":"100.24"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-21","7":"101.30"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-22","7":"100.51"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-23","7":"104.47"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-24","7":"121.92"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-25","7":"118.55"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-26","7":"85.17"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-27","7":"93.81"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-28","7":"97.36"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-29","7":"98.96"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-30","7":"103.79"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-01-31","7":"124.37"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-01","7":"122.53"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-02","7":"85.96"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-03","7":"94.62"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-04","7":"97.39"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-05","7":"102.86"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-06","7":"103.66"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-07","7":"117.63"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-08","7":"124.27"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-09","7":"88.41"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-10","7":"98.78"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-11","7":"105.64"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-12","7":"108.54"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-13","7":"115.99"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-14","7":"147.32"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-15","7":"141.24"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-16","7":"111.31"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-17","7":"111.07"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-18","7":"104.69"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-19","7":"105.82"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-20","7":"110.84"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-21","7":"132.55"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-22","7":"138.50"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-23","7":"100.83"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-24","7":"99.41"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-25","7":"100.35"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-26","7":"103.39"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-27","7":"114.33"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-28","7":"139.02"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-02-29","7":"142.31"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-01","7":"105.39"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-02","7":"105.25"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-03","7":"108.28"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-04","7":"110.71"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-05","7":"116.43"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-06","7":"137.62"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-07","7":"144.91"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-08","7":"107.11"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-09","7":"105.68"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-10","7":"109.76"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-11","7":"107.34"},{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-03-12","7":"105.61"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="exercise-10" class="section level3" number="4.3.1">
<h3 number="4.3.1"><span class="header-section-number">4.3.1</span> exercise</h3>
<p>Create <code>MaxUSCitiesDriving</code> by filtering <code>trans_type</code>, grouping on the <code>region</code> variable, and using <code>dplyr::slice_max()</code> to get the top value in <code>dir_request</code>.</p>
<pre class="r"><code>TopUSCities %&gt;%
  filter(trans_type == __________) %&gt;%
  group_by(__________) %&gt;%
  slice_max(dir_request) %&gt;%
  ungroup() -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving</code></pre>
</div>
<div id="solution-10" class="section level3" number="4.3.2">
<h3 number="4.3.2"><span class="header-section-number">4.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;%
  filter(trans_type == &quot;driving&quot;) %&gt;%
  group_by(region) %&gt;%
  slice_max(dir_request) %&gt;%
  ungroup() -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"city","2":"Chicago","3":"driving","4":"Illinois","5":"United States","6":"2020-07-17","7":"166.11"},{"1":"city","2":"Houston","3":"driving","4":"Texas","5":"United States","6":"2020-02-14","7":"146.20"},{"1":"city","2":"Los Angeles","3":"driving","4":"California","5":"United States","6":"2020-02-14","7":"152.08"},{"1":"city","2":"New York City","3":"driving","4":"New York","5":"United States","6":"2020-09-04","7":"152.09"},{"1":"city","2":"Phoenix","3":"driving","4":"Arizona","5":"United States","6":"2020-02-29","7":"142.68"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-11" class="section level3" number="4.3.3">
<h3 number="4.3.3"><span class="header-section-number">4.3.3</span> exercise</h3>
<p>Create graph labels:</p>
<ul>
<li><p>assign <code>"Peak Driving Direction Requests in Largest US Cities"</code> to <code>title</code></p></li>
<li><p>assign <code>"Max Driving Direction Requests &amp; Date"</code> to <code>subtitle</code></p></li>
</ul>
<pre class="r"><code>lab_line_max_drivers &lt;- labs(
                 x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;_________________________________&quot;,
                 subtitle = paste0(min(___________$date),
                                   &quot; through &quot;,
                                   max(___________$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;,
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-11" class="section level3" number="4.3.4">
<h3 number="4.3.4"><span class="header-section-number">4.3.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_line_max_drivers &lt;- labs(
                 x = &quot;Date&quot;,
                 y = &quot;Direction Requests&quot;,
                 title = &quot;Peak Driving Direction Requests in Largest US Cities&quot;,
                 subtitle = paste0(min(TopUSCities$date),
                                   &quot; through &quot;,
                                   max(TopUSCities$date)),
                 caption = &quot;source: https://covid19.apple.com/mobility&quot;,
                 color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="exercise-12" class="section level3" number="4.3.5">
<h3 number="4.3.5"><span class="header-section-number">4.3.5</span> exercise</h3>
<p>Create <code>max_driving_labels</code> using <code>paste0()</code> with <code>region</code> and <code>date</code>.</p>
<pre class="r"><code>MaxUSCitiesDriving %&gt;%
  mutate(
    max_driving_labels = paste0(______, &quot;, &quot;, ______)) -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving %&gt;%
  select(max_driving_labels)</code></pre>
</div>
<div id="solution-12" class="section level3" number="4.3.6">
<h3 number="4.3.6"><span class="header-section-number">4.3.6</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>MaxUSCitiesDriving %&gt;%
  mutate(max_driving_labels = paste0(region, &quot;, &quot;, date)) -&gt; MaxUSCitiesDriving
MaxUSCitiesDriving %&gt;%
  select(max_driving_labels)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["max_driving_labels"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"Chicago, 2020-07-17"},{"1":"Houston, 2020-02-14"},{"1":"Los Angeles, 2020-02-14"},{"1":"New York City, 2020-09-04"},{"1":"Phoenix, 2020-02-29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-13" class="section level3" number="4.3.7">
<h3 number="4.3.7"><span class="header-section-number">4.3.7</span> exercise</h3>
<p>Create a line plot, assigning the following values in <code>geom_label_repel()</code>:</p>
<ul>
<li>set the <code>data</code> argument to <code>MaxUSCitiesDriving</code></li>
</ul>
<p>Inside the <code>aes()</code>:</p>
<ul>
<li>map <code>label</code> to <code>max_driving_labels</code></li>
</ul>
<p>Outside the <code>aes()</code></p>
<ul>
<li>map <code>color</code> to <code>"red"</code></li>
<li>map <code>size</code> to <code>3</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
                  group = trans_type,
                  color = trans_type),
                  # make these slightly smaller again...
                  size = 0.15) +
    geom_label_repel(data = _____________,
              aes(x = date, y = dir_request,
                  label = _____________),
                  # set color and size...
                  color = _____,
                  size = _) +
  lab_line_max_drivers</code></pre>
</div>
<div id="solution-13" class="section level3" number="4.3.8">
<h3 number="4.3.8"><span class="header-section-number">4.3.8</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
                  group = trans_type,
                  color = trans_type),
                  # make these slightly smaller again...
                  size = 0.15) +
    geom_label_repel(data = MaxUSCitiesDriving,
              aes(x = date, y = dir_request,
                  label = max_driving_labels),
                  # set color and size...
                  color = &quot;red&quot;,
                  size = 3) +
  lab_line_max_drivers</code></pre>
<p><img src="img/label-plot-sol-01-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="labeling-values-2" class="section level2 tabset" number="4.4">
<h2 class="tabset" number="4.4"><span class="header-section-number">4.4</span> Labeling Values 2</h2>
<p><strong>Min Walking Requests</strong></p>
<p>We are going to repeat the process above, but use the minimum value for walking direction requests.</p>
<div id="exercise-14" class="section level3" number="4.4.1">
<h3 number="4.4.1"><span class="header-section-number">4.4.1</span> exercise</h3>
<ul>
<li><code>filter()</code> the <code>trans_type</code> to <code>"walking"</code></li>
<li><code>group_by()</code> the <code>region</code></li>
<li>use <code>slice_min()</code> to get the minimum value for <code>dir_request</code></li>
<li>Assign to <code>MinUSCitiesWalking</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;%
  filter(________ == ________) %&gt;%
  group_by(________) %&gt;%
  slice_min(dir_request) %&gt;%
  ungroup() -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
</div>
<div id="solution-14" class="section level3" number="4.4.2">
<h3 number="4.4.2"><span class="header-section-number">4.4.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;%
  filter(trans_type == &quot;walking&quot;) %&gt;%
  group_by(region) %&gt;%
  slice_min(dir_request) %&gt;%
  ungroup() -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"city","2":"Chicago","3":"walking","4":"Illinois","5":"United States","6":"2020-03-22","7":"30.86"},{"1":"city","2":"Houston","3":"walking","4":"Texas","5":"United States","6":"2020-04-12","7":"45.96"},{"1":"city","2":"Los Angeles","3":"walking","4":"California","5":"United States","6":"2020-04-12","7":"31.73"},{"1":"city","2":"New York City","3":"walking","4":"New York","5":"United States","6":"2020-03-29","7":"18.23"},{"1":"city","2":"Phoenix","3":"walking","4":"Arizona","5":"United States","6":"2020-04-12","7":"38.57"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-15" class="section level3" number="4.4.3">
<h3 number="4.4.3"><span class="header-section-number">4.4.3</span> exercise</h3>
<ul>
<li>assign <code>"Lowest Walking Direction Requests in Largest US Cities"</code> to <code>title</code></li>
</ul>
<pre class="r"><code>lab_line_min_walking &lt;- labs(
               x = &quot;Date&quot;,
               y = &quot;Direction Requests&quot;,
               title = &quot;__________________________________________&quot;,
               subtitle = paste0(min(___________$date),
                                   &quot; through &quot;,
                                 max(___________$date)),
               caption = &quot;source: https://covid19.apple.com/mobility&quot;,
               color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="solution-15" class="section level3" number="4.4.4">
<h3 number="4.4.4"><span class="header-section-number">4.4.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_line_min_walking &lt;- labs(
               x = &quot;Date&quot;,
               y = &quot;Direction Requests&quot;,
               title = &quot;Lowest Walking Direction Requests in Largest US Cities&quot;,
               subtitle = paste0(min(TopUSCities$date),
                                   &quot; through &quot;,
                                 max(TopUSCities$date)),
               caption = &quot;source: https://covid19.apple.com/mobility&quot;,
               color = &quot;Transit Type&quot;)</code></pre>
</div>
<div id="exercise-16" class="section level3" number="4.4.5">
<h3 number="4.4.5"><span class="header-section-number">4.4.5</span> exercise</h3>
<p>Create <code>min_walking_labels</code> using <code>paste0()</code> with <code>region</code> and <code>date</code></p>
<pre class="r"><code>MinUSCitiesWalking %&gt;%
  mutate(min_walking_labels = paste0(_____, &quot;, &quot;, _____)) -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
</div>
<div id="solution-16" class="section level3" number="4.4.6">
<h3 number="4.4.6"><span class="header-section-number">4.4.6</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>MinUSCitiesWalking %&gt;%
  mutate(min_walking_labels = paste0(region, &quot;, &quot;, date)) -&gt; MinUSCitiesWalking
MinUSCitiesWalking</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["geo_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["trans_type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sub_region"],"name":[4],"type":["chr"],"align":["left"]},{"label":["country"],"name":[5],"type":["chr"],"align":["left"]},{"label":["date"],"name":[6],"type":["date"],"align":["right"]},{"label":["dir_request"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["min_walking_labels"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"city","2":"Chicago","3":"walking","4":"Illinois","5":"United States","6":"2020-03-22","7":"30.86","8":"Chicago, 2020-03-22"},{"1":"city","2":"Houston","3":"walking","4":"Texas","5":"United States","6":"2020-04-12","7":"45.96","8":"Houston, 2020-04-12"},{"1":"city","2":"Los Angeles","3":"walking","4":"California","5":"United States","6":"2020-04-12","7":"31.73","8":"Los Angeles, 2020-04-12"},{"1":"city","2":"New York City","3":"walking","4":"New York","5":"United States","6":"2020-03-29","7":"18.23","8":"New York City, 2020-03-29"},{"1":"city","2":"Phoenix","3":"walking","4":"Arizona","5":"United States","6":"2020-04-12","7":"38.57","8":"Phoenix, 2020-04-12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="exercise-17" class="section level3" number="4.4.7">
<h3 number="4.4.7"><span class="header-section-number">4.4.7</span> exercise</h3>
<p>Create a line plot, assigning the following values in <code>geom_label_repel()</code>:</p>
<ul>
<li>set <code>data</code> to <code>MinUSCitiesWalking</code></li>
</ul>
<p>Inside <code>aes()</code>:</p>
<ul>
<li>map <code>min_walking_labels</code> to <code>label</code></li>
</ul>
<p>Outside <code>aes()</code>:</p>
<ul>
<li>map <code>"blue"</code> to <code>color</code></li>
<li>map <code>3</code> to <code>size</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
                  group = trans_type,
                  color = trans_type),
                  # make these slightly smaller again...
                  size = 0.15) +
    geom_label_repel(data = ____________,
              aes(x = date, y = dir_request,
                  label = ____________),
                  # set color and size...
                  color = _______,
                  size = _) +
  lab_line_min_walking</code></pre>
</div>
<div id="solution-17" class="section level3" number="4.4.8">
<h3 number="4.4.8"><span class="header-section-number">4.4.8</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;%
    ggplot() +
    geom_line(aes(x = date, y = dir_request,
                  group = trans_type,
                  color = trans_type),
                  # make these slightly smaller again...
                  size = 0.15) +
    geom_label_repel(data = MinUSCitiesWalking,
              aes(x = date, y = dir_request,
                  label = min_walking_labels),
                  # set color and size...
                  color = &quot;blue&quot;,
                  size = 3) +
  lab_line_min_walking</code></pre>
<p><img src="img/label-plot-sol-02-1.png" width="100%" height="100%" /></p>
</div>
</div>
</div>
<div id="reference-lines" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Reference lines</h1>
<p>We’re going to focus on the top 8 cites according to their <a href="https://en.wikipedia.org/wiki/List_of_United_States_cities_by_population">population</a> (the date of this writing is <code>2020-11-26</code>).</p>
<div id="top-cities" class="section level2 tabset" number="5.1">
<h2 class="tabset" number="5.1"><span class="header-section-number">5.1</span> Top Cities</h2>
<p><strong>Top Cities</strong></p>
<p>We’re going to introduce another <code>filter</code>ing method in this section to create the <code>TopUSCities</code> dataset.</p>
<div id="exercise-18" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> exercise</h3>
<p>Store top eight cities in the <code>focus_on</code> vector and use it to filter the <code>TidyApple</code> dataset.</p>
<pre class="r"><code>focus_on &lt;- c(&quot;New York City&quot;, &quot;Los Angeles&quot;,
                       &quot;Chicago&quot;, &quot;Houston&quot;,
                       &quot;Phoenix&quot;, &quot;Philadelphia&quot;,
                       &quot;San Antonio&quot;, &quot;San Diego&quot;)

TopUSCities &lt;- TidyApple %&gt;%
  filter(region %in% _____________)

TopUSCities %&gt;% glimpse(60)</code></pre>
</div>
<div id="solution-18" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>focus_on &lt;- c(&quot;New York City&quot;, &quot;Los Angeles&quot;,
              &quot;Chicago&quot;, &quot;Houston&quot;,
              &quot;Phoenix&quot;, &quot;Philadelphia&quot;,
              &quot;San Antonio&quot;, &quot;San Diego&quot;)

TopUSCities &lt;- TidyApple %&gt;%
  filter(region %in% focus_on)

TopUSCities %&gt;% glimpse(60)</code></pre>
<pre><code>## Rows: 7,608
## Columns: 7
## $ geo_type    &lt;chr&gt; &quot;city&quot;, &quot;city&quot;, &quot;city&quot;, &quot;city&quot;, &quot;city&quot;…
## $ region      &lt;chr&gt; &quot;Chicago&quot;, &quot;Chicago&quot;, &quot;Chicago&quot;, &quot;Chic…
## $ trans_type  &lt;chr&gt; &quot;driving&quot;, &quot;driving&quot;, &quot;driving&quot;, &quot;driv…
## $ sub_region  &lt;chr&gt; &quot;Illinois&quot;, &quot;Illinois&quot;, &quot;Illinois&quot;, &quot;I…
## $ country     &lt;chr&gt; &quot;United States&quot;, &quot;United States&quot;, &quot;Uni…
## $ date        &lt;date&gt; 2020-01-13, 2020-01-14, 2020-01-15, 2…
## $ dir_request &lt;dbl&gt; 100.00, 103.68, 104.45, 108.72, 132.80…</code></pre>
</div>
<div id="exercise-19" class="section level3" number="5.1.3">
<h3 number="5.1.3"><span class="header-section-number">5.1.3</span> exercise</h3>
<p><strong>Graph Labels</strong></p>
<p>We’re going to place <code>date</code> on the <code>x</code> axis, and <code>dir_request</code> on the <code>y</code>. The <code>tite</code> will reflect a general description of what we’re expecting to see, and we’ll list the cities in the <code>subtitle</code>. <code>color</code> will be used to give a better description than <code>trans_type</code>.</p>
<p>Fill in names for the <code>x</code>, <code>y</code>, and <code>color</code>.</p>
<pre class="r"><code>lab_top_cities &lt;- labs(x = _____, y  = __________,
     title = &quot;Trends of Relative Activity in Selected US Cities&quot;,
     subtitle = &quot;NY, LA, CH, HOU, PHA, PHL, SATX, SD&quot;,
     color = _________)</code></pre>
</div>
<div id="solution-19" class="section level3" number="5.1.4">
<h3 number="5.1.4"><span class="header-section-number">5.1.4</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>lab_top_cities &lt;- labs(x = &quot;Date&quot;, y  = &quot;Direction Requests&quot;,
     title = &quot;Trends of Relative Activity in Selected US Cities&quot;,
     subtitle = &quot;NY, LA, CH, HOU, PHA, PHL, SATX, SD&quot;,
     color = &quot;Type&quot;)</code></pre>
</div>
</div>
<div id="set-global-aes" class="section level2 tabset" number="5.2">
<h2 class="tabset" number="5.2"><span class="header-section-number">5.2</span> Set Global <code>aes()</code></h2>
<p>We’re going to set the global graph aesthetics inside <code>ggplot(aes())</code> using our labels as a guide. This will serve as a base layer for us to add our reference line to!</p>
<div id="exercise-20" class="section level3" number="5.2.1">
<h3 number="5.2.1"><span class="header-section-number">5.2.1</span> exercise</h3>
<p><strong>Global <code>aes()</code></strong></p>
<ul>
<li><p>Map <code>trans_type</code> to <code>group</code> and <code>color</code></p></li>
<li><p>Also add a <code>geom_line()</code> layer with the <code>size</code> set to <code>0.1</code> (not inside the <code>aes()</code>!)</p></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;%
  ggplot(aes(x = date, y = dir_request,
             _____ = __________,
             _____ = __________)) +
  ____________(_____ = ___) +
  lab_top_cities</code></pre>
</div>
<div id="solution-20" class="section level3" number="5.2.2">
<h3 number="5.2.2"><span class="header-section-number">5.2.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;%
  ggplot(aes(x = date, y = dir_request,
             group = trans_type,
             color = trans_type)) +
  geom_line(size = 0.1) +
  lab_top_cities</code></pre>
<p><img src="img/TopUSCities-geom_line-sol-1.png" width="100%" height="100%" /></p>
</div>
</div>
<div id="reference-line-layer" class="section level2 tabset" number="5.3">
<h2 class="tabset" number="5.3"><span class="header-section-number">5.3</span> Reference Line Layer</h2>
<p>The documentation for the data tells us each <code>dir_request</code> has a baseline value of <code>100</code>. We’re going to add this as a reference line on the graph using <code>ggplot2::geom_hline()</code>.</p>
<div id="exercise-21" class="section level3" number="5.3.1">
<h3 number="5.3.1"><span class="header-section-number">5.3.1</span> exercise</h3>
<p>The <code>geom_hline()</code> function takes <code>yintercept</code>, <code>size</code>, and <code>color</code> arguments.</p>
<ul>
<li>use our baseline value of <code>100</code> as the <code>yintercept</code></li>
<li>set the <code>size</code> to <code>0.2</code></li>
<li>make the <code>color</code> of this line <code>"gray20"</code></li>
</ul>
<pre class="r"><code>TopUSCities %&gt;%
  ggplot(aes(x = date, y = dir_request,
             group = trans_type,
             color = trans_type)) +
  geom_line(size = 0.1) +
  # add reference line
  geom_hline(yintercept = ___, size = ___, color = _______) +
  lab_top_cities</code></pre>
</div>
<div id="solution-21" class="section level3" number="5.3.2">
<h3 number="5.3.2"><span class="header-section-number">5.3.2</span> solution</h3>
<p>See below:</p>
<pre class="r"><code>TopUSCities %&gt;%
  ggplot(aes(x = date, y = dir_request,
             group = trans_type,
             color = trans_type)) +
  geom_line(size = 0.1) +
  geom_hline(yintercept = 100, size = 0.2, color = &quot;gray20&quot;) +
  lab_top_cities</code></pre>
<p><img src="img/geom_hline-sol-1.png" width="100%" height="100%" /></p>
<p>Reference lines are helpful when we want to examine trends in relation to a particular value.</p>
</div>
</div>
</div>

<i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5,h6",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
