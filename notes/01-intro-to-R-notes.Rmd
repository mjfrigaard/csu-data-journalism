---
title: "The R language"
author: 
- Martin Frigaard
date: "`r Sys.Date()`"
output: memor::pdf_memo
---

```{r setup, include=FALSE}
library(knitr)
library(memor)
library(tidyverse)
opts_chunk$set(warning = FALSE, message = FALSE)
```

R is an object-oriented, functional programming language for statistical analysis and graphics. R is also a free and open-source software (FOSS) with a massive global community of users and developers who have helped create and maintain tools for data manipulation, graphics, statistics, and machine learning.

## Functions and objects 

The R language is comprised of functions and objects. R uses functions to perform operations (like `mean()`, `sum()`, `lm()` (for linear model)) on objects (vectors, arrays, matrices, data.frames or lists).

Generally speaking, functions are similar to _verbs_, and objects are more like _nouns_. Functions typically take an object as an `input`, perform an operation on that object, and then return an `output` object. 

```{r example-function, eval=FALSE}
object <- function('input') {

    perform operation(s) on 'input'

    return output
}
# view object
object
```

## Base R packages 

R `packages` are collections of commands for a particular purpose or task. R comes 'out of the box' with a ton of functions for manipulating, analyzing, and visualizing data. Two of the most commonly used standard packages are `base` and `utils`. 

You can access any function in a package using the `package::function()` syntax. If you're in RStudio, you can actually see the functions in each package by using the tab-completion feature:

```{r package-functions.png, echo=FALSE, fig.align='center', out.width='5in', out.height='3in'}
knitr::include_graphics(path = "../img/package-functions.png")
```

If you hover over the function with your mouse cursor, you'll also see the arguments and documentation for each function. 

```{r function-args.png, echo=FALSE, fig.align='center', out.width='5in', out.height='2in'}
knitr::include_graphics(path = "../img/function-args.png")
```

When you're using the `utils::install.packages()` function, the package files are installed from the [Comprehensive R Archive Network](https://cran.r-project.org/), or CRAN. These packages have passed a variety of tests and are generally considered to be more reliable. 

## User-written packages 

Most of the packages we'll be using in this course come from the `tidyverse,` which is a suite of tools pioneered by RStudio's Chief Scientist [Hadley Wickham](http://hadley.nz/). All packages in the `tidyverse` work well together because they center around a common thread of [tidy data](https://vita.had.co.nz/papers/tidy-data.pdf).

To install and load the `tidyverse`, we will use the `utils::install.packages()` function to download and installs R packages into a local folder on our computer, and the `base::library()` command loads the packages.

```{r install-tidyverse, message=FALSE, warning=FALSE, results='hide', eval=FALSE}
install.packages("tidyverse")
library(tidyverse)
```

**NOTE: Not all functions return an output. Some functions return messages (or prompts), so be sure to check the help files by using `?install.packages` in the console.**

User-written packages can be installed from code repositories like [Github.](https://github.com/) 

First you will need to install the `remotes` package from CRAN, then you can use the `remotes::install_github()`

```{r install-remotes, eval=FALSE, message=FALSE, warning=FALSE, results='hide'}
install.packages("remotes")
library(remotes)
```

Now we can use the `remotes::install_github()` to download and install the `tidyverse` package. 

```{r install-github, eval=FALSE, message=FALSE, warning=FALSE, results='hide'}
remotes::install_github("tidyverse/tidyverse")
library(tidyverse)
```

**Note: when installing packages from Github or other repos, you're getting the 'freshest' version, so there might be bugs or errors. If you run into an issue, look for a version of the package on CRAN**

## Creating objects   

R comes with a variety of functions for creating objects. We will start with `c()`, which stands for 'combine' or 'concatenate'. 

We can print this to the console by supplying the new object and hitting enter/return.

```{r create-c}
x <- c(42, 34, 28, 53, 71, 30, 23, 72, 59, 46, 64, 33, 42, 50, 68)
x
```


*A quick note on printing: notice the preceding `[1]` in the output. This is not part of the object, it's the line number for the output.*

Now that we have an object in R, what do we do with it? We will start by taking a look at some of it's technical information using `class()` and `str()`

```{r class-x}
class(x) 
```

The `class()` function tells us `x` is a `numeric` vector. The `str()` function is an abbreviation for 'structure', and it gives us a bit more information. 

```{r str-x}
str(x)
```

I recommend using `str()` and `class()` when you're programming in R. Knowing what kind of object you're dealing with will help you determine what you can do with it. 

## Store and explore

Given the relationship between functions and objects, a common workflow is to create (or import) data as an object (`my_data`), apply a function to this object (`log10()`), store the output from this function in a new object (`my_result`), and then use other functions to explore the `my_result`: 

```{r store-and-explore}
# create data  
my_data <- c(49, 147, 74, 90, 7, -79, 190, 49, -123, -325, 143, 232)
# apply a function and store in my_result
my_result <- sqrt(my_data)
# explore the result
summary(my_result)
```


*Operators* are symbols (or collections of symbols) for performing arithmetic (`+`, `-`, `*`, `/`), comparisons (`<`, `>`, `=<`, `=>`), and assignment (`<-` and `=`). *Operators* are also functions (see below). 

```{r operators}
class(`+`)
class(`<=`)
class(`<-`)
```


## Data in R

When we load data into R, these data get stored in a data object. To do things to any data object (manipulate, analyze, visualize, model, etc.), we'll need to use functions. We can write custom functions, or we can use one of the over 10,000 user-written packages available on [CRAN](https://cran.r-project.org/).


## R Code style

The code in this scenario follows the [`tidyverse` style guide](https://style.tidyverse.org/) as closely as possible.

> "*Each line of a comment should begin with the comment symbol and a single space: `#`*"

```{r comments}
# comments aren't run in the console
```

> "*In data analysis code, use comments to record important findings and analysis decisions. If you need comments to explain what your code is doing, consider rewriting your code to be clearer.*"

## Using R functions

If we want to use a function from a package, the syntax for doing this is `package::function()`

For example, below, we'll use the `tidyverse_logo()` function from the `tidyverse` package to view an awesome logo.

```{r tidyverse_logo}
# click to execute code
tidyverse::tidyverse_logo()
```

The `tidyverse::tidyverse_logo()` function can run without any arguments (i.e. nothing inside the parentheses), but we can view the arguments by placing the cursor inside the parenthesis and hitting the <kbd>tab</kbd> key.

We can enter function arguments by position or name (see below).

<!-- ![](https://github.com/mjfrigaard/katacoda-scenarios/blob/master/figs/00-name-arg.png?raw=true) -->

<!-- ![](https://github.com/mjfrigaard/katacoda-scenarios/blob/master/figs/00-position-arg.png?raw=true) -->


1. Tacutu, R., Craig, T., Budovsky, A., Wuttke, D., Lehmann, G., Taranukha, D., Costa, J., Fraifeld, V. E., de Magalhaes, J. P. (2013) "Human Ageing Genomic Resources: Integrated databases and tools for the biology and genetics of ageing." Nucleic Acids Research 41(D1):D1027-D1033. 
