<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Visualization with ggplot2 (part 1)</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CSUC Data Journalism</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Course outline</a>
</li>
<li>
  <a href="lessons-exercises.html">Lessons and exercises</a>
</li>
<li>
  <a href="slides.html">Slides</a>
</li>
<li>
  <a href="more-resources.html">More resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data Visualization with ggplot2 (part 1)</h1>

</div>


<div id="objectives" class="section level2" number="0.1">
<h2><span class="header-section-number">0.1</span> Objectives</h2>
<p>This document outlines and introduction to data visualization with <code>ggplot2</code>. The objectives for this section are:</p>
<ul>
<li><p>Explain the problem having a <em>Grammar of Graphics</em> solves</p></li>
<li><p>Define the terms <code>geom</code>, <code>aesthetic</code> and <code>layer</code></p></li>
<li><p>Understand the <code>ggplot2</code> graph template, and how to use it to build a variety of graphs</p></li>
<li><p>Recognize the differences between global and local aesthetic mappings and mapping and setting aesthetic attributes</p></li>
</ul>
</div>
<div id="materials" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Materials</h1>
<p>View the slides for this section <a href="https://mjfrigaard.github.io/csuc-data-journalism/slides.html">here</a>.</p>
<p>View the exercises for this section <a href="https://mjfrigaard.github.io/csuc-data-journalism/lessons-exercises.html">here</a>.</p>
<div id="background" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Background</h2>
<p>You might want to check out the <a href="https://r4ds.had.co.nz/transform.html">Data Transformation</a> and <a href="https://r4ds.had.co.nz/tidy-data.html">Tidy Data</a> chapters of R for Data Science.</p>
</div>
<div id="load-the-packages" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Load the packages</h2>
<p>The main packages we’re going to use are <code>ggplot2</code>, <code>dplyr</code>, and <code>tidyr</code>. These are all part of the <code>tidyverse</code>, so we’ll import this package below:</p>
<pre class="r"><code>install.packages(&quot;tidyverse&quot;)
library(tidyverse)</code></pre>
</div>
<div id="import-data" class="section level2 tabset" number="1.3">
<h2 class="tabset"><span class="header-section-number">1.3</span> Import data</h2>
<p>For this section, we’re going to be using the datasets in the <code>ggplot2</code> package. Normally we import data ‘in the wild’, but for these examples we want to focus on the <code>ggplot2</code> grammar, not necessarily the data processing/wrangling steps.</p>
<p>We’re going to start with the <code>ggplot2::diamonds</code> dataset. This contains `<em>A dataset containing the prices and other attributes of almost 54,000 diamonds.</em></p>
<div id="exercise" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> exercise</h3>
<p>Use <code>dplyr::glimpse()</code>, <code>utils::head()</code>, and <code>utils::tail()</code>, to view the <code>diamonds</code> dataset.</p>
<pre class="r"><code>dplyr::glimpse(________)
utils::____(ggplot2::diamonds)
utils::____(ggplot2::diamonds)</code></pre>
</div>
<div id="solution" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>dplyr::glimpse(ggplot2::diamonds)</code></pre>
<pre><code>## Rows: 53,940
## Columns: 10
## $ carat   &lt;dbl&gt; 0.23, 0.21, 0.23, 0.29, 0.31, 0.24, 0.24, …
## $ cut     &lt;ord&gt; Ideal, Premium, Good, Premium, Good, Very …
## $ color   &lt;ord&gt; E, E, E, I, J, J, I, H, E, H, J, J, F, J, …
## $ clarity &lt;ord&gt; SI2, SI1, VS1, VS2, SI2, VVS2, VVS1, SI1, …
## $ depth   &lt;dbl&gt; 61.5, 59.8, 56.9, 62.4, 63.3, 62.8, 62.3, …
## $ table   &lt;dbl&gt; 55, 61, 65, 58, 58, 57, 57, 55, 61, 61, 55…
## $ price   &lt;int&gt; 326, 326, 327, 334, 335, 336, 336, 337, 33…
## $ x       &lt;dbl&gt; 3.95, 3.89, 4.05, 4.20, 4.34, 3.94, 3.95, …
## $ y       &lt;dbl&gt; 3.98, 3.84, 4.07, 4.23, 4.35, 3.96, 3.98, …
## $ z       &lt;dbl&gt; 2.43, 2.31, 2.31, 2.63, 2.75, 2.48, 2.47, …</code></pre>
<pre class="r"><code>utils::head(ggplot2::diamonds)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carat"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cut"],"name":[2],"type":["ord"],"align":["right"]},{"label":["color"],"name":[3],"type":["ord"],"align":["right"]},{"label":["clarity"],"name":[4],"type":["ord"],"align":["right"]},{"label":["depth"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["table"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["price"],"name":[7],"type":["int"],"align":["right"]},{"label":["x"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["z"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.23","2":"Ideal","3":"E","4":"SI2","5":"61.5","6":"55","7":"326","8":"3.95","9":"3.98","10":"2.43"},{"1":"0.21","2":"Premium","3":"E","4":"SI1","5":"59.8","6":"61","7":"326","8":"3.89","9":"3.84","10":"2.31"},{"1":"0.23","2":"Good","3":"E","4":"VS1","5":"56.9","6":"65","7":"327","8":"4.05","9":"4.07","10":"2.31"},{"1":"0.29","2":"Premium","3":"I","4":"VS2","5":"62.4","6":"58","7":"334","8":"4.20","9":"4.23","10":"2.63"},{"1":"0.31","2":"Good","3":"J","4":"SI2","5":"63.3","6":"58","7":"335","8":"4.34","9":"4.35","10":"2.75"},{"1":"0.24","2":"Very Good","3":"J","4":"VVS2","5":"62.8","6":"57","7":"336","8":"3.94","9":"3.96","10":"2.48"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>utils::tail(ggplot2::diamonds)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carat"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cut"],"name":[2],"type":["ord"],"align":["right"]},{"label":["color"],"name":[3],"type":["ord"],"align":["right"]},{"label":["clarity"],"name":[4],"type":["ord"],"align":["right"]},{"label":["depth"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["table"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["price"],"name":[7],"type":["int"],"align":["right"]},{"label":["x"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["z"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.72","2":"Premium","3":"D","4":"SI1","5":"62.7","6":"59","7":"2757","8":"5.69","9":"5.73","10":"3.58"},{"1":"0.72","2":"Ideal","3":"D","4":"SI1","5":"60.8","6":"57","7":"2757","8":"5.75","9":"5.76","10":"3.50"},{"1":"0.72","2":"Good","3":"D","4":"SI1","5":"63.1","6":"55","7":"2757","8":"5.69","9":"5.75","10":"3.61"},{"1":"0.70","2":"Very Good","3":"D","4":"SI1","5":"62.8","6":"60","7":"2757","8":"5.66","9":"5.68","10":"3.56"},{"1":"0.86","2":"Premium","3":"H","4":"SI2","5":"61.0","6":"58","7":"2757","8":"6.15","9":"6.12","10":"3.74"},{"1":"0.75","2":"Ideal","3":"D","4":"SI2","5":"62.2","6":"55","7":"2757","8":"5.83","9":"5.87","10":"3.64"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="intro-to-ggplot2" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Intro to <code>ggplot2</code></h2>
<p>Within the <code>tidyverse</code>, the <code>ggplot2</code> package provides a grammar (or set of rules) to develop a rich vocabulary for building data visualizations. Knowing how to use <code>ggplot2</code>’s grammar also gives us an excellent mental model for thinking about individual graphical elements.</p>
</div>
<div id="terms-and-definitions-geoms-and-aesthetics" class="section level2 tabset" number="1.5">
<h2 class="tabset"><span class="header-section-number">1.5</span> Terms and definitions: geoms and aesthetics</h2>
<p>The <em>geom</em> (or geometric object) is the fundamental building block in the <code>ggplot2</code> language. <code>geom</code>s are the shape or element we will see on the graph or plot, and include things like points or lines, bars, etc. <code>geoms</code> also have <code>aes</code>thetic mappings, which are visual properties of the shape on the plot or graph (i.e. the color of the point, the size of the lines, the position or shape of the bars, etc.).</p>
<p>So every graph or plot has a <code>geom</code>, and all <code>geom</code>s will also have some visual properties called <code>aes</code>thetics.</p>
<div id="exercise-1" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> exercise</h3>
<p>Use the pipe syntax below to apply the <code>ggplot2::ggplot()</code> and <code>ggplot2::aes()</code> functions to the <code>WikiCovid</code> data.</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::_______(ggplot2::___())</code></pre>
</div>
<div id="solution-1" class="section level3" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes())</code></pre>
<p><img src="img/ggplot-aes-sol-1.png" width="864" /></p>
<p>When we combine a dataset with the <code>ggplot2::ggplot()</code> and <code>ggplot2::aes()</code> functions, we get a blank canvas. This is the base layer for <code>ggplot2</code> graphs. Next we will see what happens when we ‘map’ variables to their respective positions (<code>x</code> and <code>y</code>).</p>
</div>
</div>
<div id="build-labels-first" class="section level2 tabset" number="1.6">
<h2 class="tabset"><span class="header-section-number">1.6</span> Build labels first!</h2>
<p>I <strong>strongly suggest</strong> building labels first when making a figure or graph because it forces us to think about what we should expect to see. For example, if we want to see <code>price</code> on the <code>y</code> and <code>carat</code> on the <code>x</code>, we can create these labels (along with a <code>title</code> and <code>caption</code>) using the <code>ggplot2::labs()</code> function below.</p>
<p><em>Note the use of the <code>paste0()</code> function to ensure the date matches the same day we scraped the data.</em></p>
<pre class="r"><code>labs_caratVSprice &lt;- ggplot2::labs(
                              title = &quot;Diamond carat vs. price&quot;, 
                              caption = &quot;https://ggplot2.tidyverse.org/reference/diamonds.html&quot;,
                              x = &quot;Weight of the diamond&quot;, 
                              y = &quot;Price in US dollars&quot;)</code></pre>
<p>Now we can refer to the labels to add the variables to our existing canvas.</p>
</div>
<div id="mapping-aesthetics" class="section level2 tabset" number="1.7">
<h2 class="tabset"><span class="header-section-number">1.7</span> Mapping aesthetics</h2>
<p>We’re going to take the <code>diamonds</code> dataset, and pipe (<code>%&gt;%</code>) it over to the <code>ggplot()</code> and <code>aes()</code> function (short for aesthetics). This ‘initializes’ the <code>ggplot2</code> plot, and the <code>aes()</code> function tells <code>ggplot2</code> which variables we want ‘mapped’ to each location or position aesthetic.</p>
<p>See the example below:</p>
<p><img src="img/ggplot2-diamonds-template.png" width="796" /></p>
<p>Structuring the code this way makes it easier to separate the input dataset (<code>DataSet</code>) from the code that initializes the plot (<code>ggplot(aes())</code>). In the future, this comes in handy if we want to manipulate the data before creating a graph.</p>
<div id="exercise-2" class="section level3" number="1.7.1">
<h3><span class="header-section-number">1.7.1</span> exercise</h3>
<p>Use the labels to guide you in filling in the <code>aes()</code> function below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = _____, y = ______)) </code></pre>
</div>
<div id="solution-2" class="section level3" number="1.7.2">
<h3><span class="header-section-number">1.7.2</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price))</code></pre>
<p><img src="img/mapping-aes-sol-1.png" width="864" /></p>
</div>
</div>
<div id="adding-layers-with" class="section level2 tabset" number="1.8">
<h2 class="tabset"><span class="header-section-number">1.8</span> Adding layers with <code>+</code></h2>
<p>Up to this point, we’ve been using the pipe (<code>%&gt;%</code>) to combine function calls into clear, readable, linear code ‘pipelines’. <code>ggplot2</code> deviates from this syntax and uses the <code>+</code> symbol for adding layers to plot objects. This can be confusing at first, but it becomes clear as soon as you identify where the plot is initialized.</p>
<p>We currently have a dataset (<code>diamonds</code>) and a label object in our working environment (<code>labs_caratVSprice</code>). If we check the structure at each step, we can see where the plot’s been created (and it’s appropriate to use the <code>+</code> symbol).</p>
<pre class="r"><code># use class() to check what is being &#39;piped&#39; to ggplot(aes()):
diamonds %&gt;% class()</code></pre>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<pre class="r"><code>  # ggplot2::ggplot(ggplot2::aes(x = carat, y = price))</code></pre>
<pre class="r"><code>diamonds %&gt;% 
  # add class() to check what&#39;s being created here:
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) %&gt;% class()</code></pre>
<pre><code>## [1] &quot;gg&quot;     &quot;ggplot&quot;</code></pre>
<p>Initializing the plot creates a <code>gg</code> or <code>ggplot</code> object, which requires us to use the <code>+</code> symbol to add layers. The label object is designed to work specifically with <code>gg</code>/<code>ggplot</code> objects, which we can see with the <code>class()</code> function:</p>
<pre class="r"><code>class(labs_caratVSprice)</code></pre>
<pre><code>## [1] &quot;labels&quot;</code></pre>
<p><img src="img/ggplot-initialized.png" width="700" /></p>
<div id="exercise-3" class="section level3" number="1.8.1">
<h3><span class="header-section-number">1.8.1</span> exercise</h3>
<p>Add the label object <code>labs_caratVSprice</code> to the code below to assign put labels on the graph object.</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) _ # &lt;- use the appropriate symbol!
  _______________</code></pre>
</div>
<div id="solution-3" class="section level3" number="1.8.2">
<h3><span class="header-section-number">1.8.2</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) + 
  labs_caratVSprice</code></pre>
<p><img src="img/labs_location_vaccinated-sol-1.png" width="864" /></p>
<p>This is starting to look more like a graph! We have the <code>x</code> and <code>y</code> axis defined, the <code>title</code> tells us what we should expect to see, and the <code>caption</code> gives us a clue to the data source.</p>
</div>
</div>
<div id="adding-geometric-layers" class="section level2 tabset" number="1.9">
<h2 class="tabset"><span class="header-section-number">1.9</span> Adding geometric layers</h2>
<p>Now that we have <code>price</code> and <code>carat</code> mapped to their respective aesthetic positions, we will add another <code>geom</code> layer. Layers are to <code>ggplto2</code> graphs what sentences are to paragraphs, We construct sentences with verbs and nouns, and separate them with punctuation. Layers are built using geoms and aesthetics, and we separate these layers using the <code>+</code> symbol.</p>
<div id="exercise-4" class="section level3" number="1.9.1">
<h3><span class="header-section-number">1.9.1</span> exercise</h3>
<p>Add the <code>geom_point()</code> to the code below, before the labels:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) + 
  _________() + 
  labs_caratVSprice</code></pre>
</div>
<div id="solution-4" class="section level3" number="1.9.2">
<h3><span class="header-section-number">1.9.2</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) + 
  ggplot2::geom_point() + 
  labs_caratVSprice</code></pre>
<p><img src="img/geom-layer-sol-1.png" width="864" /></p>
<p>There we have it! Our first graph! Now we’re going to add a few more aesthetics like <code>color</code> and <code>size</code>.</p>
</div>
</div>
<div id="ggplot2-a-template" class="section level2" number="1.10">
<h2><span class="header-section-number">1.10</span> <code>ggplot2</code>: A template</h2>
<p>We’ve just built our first graph with <code>ggplot2</code>, so lets take a second to see what we’ve learned:</p>
<ol style="list-style-type: decimal">
<li>Start with a dataset (<code>diamonds</code>)</li>
<li>Pipe the data to <code>ggplot()</code> and <code>aes()</code> to initialize the plot object<br />
</li>
<li>Assign aesthetic mappings to positions on the plot (<code>x</code> and <code>y</code>)<br />
</li>
<li>Add a geometric layer (<code>geom_point()</code>)</li>
</ol>
<p>We can make abstract each step and come up with the following template:</p>
<p><img src="img/ggplot2-template-01.png" width="706" /></p>
<p>As you can see, the <code>geom</code> functions come with their own set of aesthetic mappings, which we will explore next. But first, we need to cover the difference between mapping aesthetics globally vs. mapping variables locally.</p>
</div>
<div id="global-vs.-local-aesthetics" class="section level2 tabset" number="1.11">
<h2 class="tabset"><span class="header-section-number">1.11</span> Global vs. local aesthetics</h2>
<p>When we mapped <code>carat</code> and <code>price</code> to the <code>x</code> and <code>y</code> axis inside <code>ggplot2(mapping = aes())</code>, we set these positions globally, which means they will be inherited at each layer of the graph. See the figure below:</p>
<p><img src="img/global-mappings.png" width="922" /></p>
<p>Each <code>geom</code> function also comes with it’s own options for aesthetic mappings, which we can use to customize the graph at each layer.</p>
<p><img src="img/local-mappings.png" width="936" /></p>
<p>We will see how this works with a few exercises.</p>
<div id="exercise-5" class="section level3" number="1.11.1">
<h3><span class="header-section-number">1.11.1</span> exercise</h3>
<p>Map the <code>cut</code> variable to the <code>color</code> aesthetic inside the global <code>ggplot(aes())</code> functions (<code>cut</code> is the <em>quality of the cut (Fair, Good, Very Good, Premium, Ideal)</em>).</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price, _____ = ___)) + 
  ggplot2::geom_point() + 
  labs_caratVSprice</code></pre>
</div>
<div id="solution-5" class="section level3" number="1.11.2">
<h3><span class="header-section-number">1.11.2</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price, color = cut)) + 
  ggplot2::geom_point() + 
  labs_caratVSprice</code></pre>
<p><img src="img/global-aes-color-sol-1.png" width="864" /></p>
<p>As we can see, there were five levels to the <code>cut</code> variable, and each level has it’s own unique color.</p>
</div>
<div id="exercise-6" class="section level3" number="1.11.3">
<h3><span class="header-section-number">1.11.3</span> exercise</h3>
<p>Add the <code>clarity</code> variable to the <code>geom_point(aes())</code> function below to map the values to different colors locally (<code>clarity</code> is “<em>a measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best))</em>”).</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price, color = cut)) + 
  ggplot2::geom_point(aes(_____ = ___)) + 
  labs_caratVSprice</code></pre>
</div>
<div id="solution-6" class="section level3" number="1.11.4">
<h3><span class="header-section-number">1.11.4</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price, color = cut)) + 
  ggplot2::geom_point(aes(color = clarity)) + 
  labs_caratVSprice</code></pre>
<p><img src="img/local-aes-color-sol-1.png" width="864" /></p>
<p>Note that the <code>color = cut</code> mapping inside the global setting is overridden by the local mapping inside the <code>geom_point()</code> function, and we can see there is a clear relationship between clarity and <code>carat</code>.</p>
</div>
</div>
<div id="additional-aesthetic-mappings" class="section level2 tabset" number="1.12">
<h2 class="tabset"><span class="header-section-number">1.12</span> Additional aesthetic mappings</h2>
<p>The points in the graph above are all stacked on top of each other. This is called over-plotting, and we can fix it with the <code>alpha</code> argument.</p>
<div id="exercise-7" class="section level3" number="1.12.1">
<h3><span class="header-section-number">1.12.1</span> exercise</h3>
<p>Set the <code>alpha</code> argument to <code>1/3</code> inside the <code>geom_point()</code>, after the <code>aes()</code> function.</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price, color = cut)) +  
  ggplot2::geom_point(aes(color = clarity), 
             _____ = _/_) + 
  labs_caratVSprice</code></pre>
</div>
<div id="solution-7" class="section level3" number="1.12.2">
<h3><span class="header-section-number">1.12.2</span> solution</h3>
<p>See solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price, color = cut)) +  
  ggplot2::geom_point(aes(color = clarity), 
             alpha = 1/3) + 
  labs_caratVSprice</code></pre>
<p><img src="img/alpha-point-sol-1.png" width="864" /></p>
</div>
</div>
<div id="setting-vs.-mapping" class="section level2 tabset" number="1.13">
<h2 class="tabset"><span class="header-section-number">1.13</span> Setting vs. mapping</h2>
<p>When we map a variable to an aesthetic like <code>color</code>, different values for this variable (<code>"Fair"</code>, <code>"Good"</code>, <code>"Very Good"</code>, <code>"Premium"</code>, <code>"Ideal"</code>) to different colors. You can access these colors using the <code>ggplot2::build()</code> function, then extracting the information stored in data <code>data[[1]]$colour</code>:</p>
<pre class="r"><code># create plot
p &lt;- diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price, color = cut)) + 
  ggplot2::geom_point() + 
  labs_caratVSprice
# build 
ggbld &lt;- ggplot2::ggplot_build(p)
# get colors 
base::unique(ggbld$data[[1]]$colour)</code></pre>
<pre><code>## [1] &quot;#FDE725FF&quot; &quot;#5DC863FF&quot; &quot;#3B528BFF&quot; &quot;#21908CFF&quot;
## [5] &quot;#440154FF&quot;</code></pre>
<p>These colors have a hexadecimal code and are matched up in the plot legend:</p>
<p><img src="img/color-mapping.png" width="271" /></p>
<p>Mapping involves assigning variable values to visual attributes, but setting involves assigning aesthetic attributes manually. We will explore the differences below:</p>
<div id="exercise-8" class="section level3" number="1.13.1">
<h3><span class="header-section-number">1.13.1</span> exercise</h3>
<p>Set the color aesthetic to <code>"dodgerblue"</code> inside the <code>geom_point()</code> function.</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) + 
  ggplot2::geom_point(color = _____________) + 
  labs_caratVSprice</code></pre>
</div>
<div id="solution-8" class="section level3" number="1.13.2">
<h3><span class="header-section-number">1.13.2</span> solution</h3>
<p>See the solution below:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) + 
  ggplot2::geom_point(color = &quot;dodgerblue&quot;) + 
  labs_caratVSprice</code></pre>
<p><img src="img/setting-color-sol-1.png" width="864" /></p>
</div>
<div id="mapping-setting" class="section level3" number="1.13.3">
<h3><span class="header-section-number">1.13.3</span> mapping ≠ setting</h3>
<p>If you accidentally map a color value you meant to set by placing it inside the <code>aes()</code> function, you will see the following:</p>
<pre class="r"><code>diamonds %&gt;% 
  ggplot2::ggplot(ggplot2::aes(x = carat, y = price)) + 
  ggplot2::geom_point(aes(color = &quot;dodgerblue&quot;)) + 
  labs_caratVSprice</code></pre>
<p><img src="img/map-instead-of-set-1.png" width="864" /></p>
<p>Here we can see the value (<code>"dodgerblue"</code>) is assigned as a level in the <code>colour</code> scale, but the color is assigned to a default visual attribute.</p>
</div>
</div>
<div id="review" class="section level2" number="1.14">
<h2><span class="header-section-number">1.14</span> Review</h2>
<p>We’ve covered an introduction on how the grammar of graphics is implemented in <code>ggplot2</code>, and how using a template can guide us in building a huge variety of graphs. We learned that it’s best to start with graph labels to make sure we’re seeing what we were expecting, We demonstrated how global mappings are inhereted at each graph layer, and that we can override these mappings by providing local aesthetics. We’ve also seen the difference between setting and mapping aesthetic attributes to a graph layer.</p>
</div>
</div>

<i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5,h6",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
